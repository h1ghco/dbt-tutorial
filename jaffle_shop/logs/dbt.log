

============================== 2022-10-18 07:29:28.121643 | 6bc4eca0-7b74-48e2-8424-098e347ff1ad ==============================
[0m07:29:28.121659 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:29:28.122612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:29:28.122866 [debug] [MainThread]: Tracking: tracking
[0m07:29:28.271572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257c3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257c3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257c9b50>]}
[0m07:29:28.775231 [debug] [MainThread]: Executing "git --help"
[0m07:29:28.817667 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m07:29:28.819700 [debug] [MainThread]: STDERR: "b''"
[0m07:29:28.930107 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m07:29:28.932415 [debug] [MainThread]: Using postgres connection "debug"
[0m07:29:28.933434 [debug] [MainThread]: On debug: select 1 as id
[0m07:29:28.933887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:28.938640 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:29:28.939674 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m07:29:28.939855 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m07:29:28.940041 [debug] [MainThread]: On debug: No close available on handle
[0m07:29:28.940699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257b7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257b2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93257b2e50>]}
[0m07:29:28.941192 [debug] [MainThread]: Flushing usage events
[0m07:29:29.891019 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-18 07:30:27.326993 | 83333bca-fda7-474f-ad88-a4f88053f296 ==============================
[0m07:30:27.327009 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:30:27.328187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:30:27.328594 [debug] [MainThread]: Tracking: tracking
[0m07:30:27.407857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220c6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220c6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220c6e10>]}
[0m07:30:27.623134 [debug] [MainThread]: Executing "git --help"
[0m07:30:27.660264 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m07:30:27.661514 [debug] [MainThread]: STDERR: "b''"
[0m07:30:27.667529 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m07:30:27.669972 [debug] [MainThread]: Using postgres connection "debug"
[0m07:30:27.670235 [debug] [MainThread]: On debug: select 1 as id
[0m07:30:27.670458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:27.671717 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "127.0.0.1", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:30:27.672472 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m07:30:27.672655 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m07:30:27.672966 [debug] [MainThread]: On debug: No close available on handle
[0m07:30:27.673756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220bf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3220ba150>]}
[0m07:30:27.674560 [debug] [MainThread]: Flushing usage events
[0m07:30:28.558823 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-18 07:31:28.129628 | 5d0c55ee-58aa-4d5b-b841-d8db0744543a ==============================
[0m07:31:28.129642 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:31:28.130744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:31:28.131161 [debug] [MainThread]: Tracking: tracking
[0m07:31:28.152803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b106890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b106150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b106510>]}
[0m07:31:28.256968 [debug] [MainThread]: Executing "git --help"
[0m07:31:28.265829 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m07:31:28.266648 [debug] [MainThread]: STDERR: "b''"
[0m07:31:28.272445 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m07:31:28.273908 [debug] [MainThread]: Using postgres connection "debug"
[0m07:31:28.274201 [debug] [MainThread]: On debug: select 1 as id
[0m07:31:28.274448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:28.403483 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "192.168.0.174", port 5432 failed: FATAL:  password authentication failed for user "tradekit"

[0m07:31:28.452100 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m07:31:28.452672 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m07:31:28.453186 [debug] [MainThread]: On debug: No close available on handle
[0m07:31:28.454919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1ec650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1d71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1d7890>]}
[0m07:31:28.455964 [debug] [MainThread]: Flushing usage events
[0m07:31:29.545041 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-18 07:32:07.812286 | 4faabb64-1326-42be-9f9d-352b6fa71192 ==============================
[0m07:32:07.812301 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:32:07.813117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m07:32:07.813299 [debug] [MainThread]: Tracking: tracking
[0m07:32:07.833844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe028c6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe028c6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe028c6090>]}
[0m07:32:08.006169 [debug] [MainThread]: Executing "git --help"
[0m07:32:08.065827 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m07:32:08.067767 [debug] [MainThread]: STDERR: "b''"
[0m07:32:08.074871 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m07:32:08.076195 [debug] [MainThread]: Using postgres connection "debug"
[0m07:32:08.076396 [debug] [MainThread]: On debug: select 1 as id
[0m07:32:08.076630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:08.230380 [debug] [MainThread]: SQL status: SELECT 1 in 0.15 seconds
[0m07:32:08.235481 [debug] [MainThread]: On debug: Close
[0m07:32:08.236477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe028ae5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02997dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe02997990>]}
[0m07:32:08.237193 [debug] [MainThread]: Flushing usage events
[0m07:32:08.851643 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-10-18 07:32:18.705723 | dc476c0f-9b41-49cd-ac75-77ab41f0b6d5 ==============================
[0m07:32:18.705814 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:32:18.706901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:32:18.707231 [debug] [MainThread]: Tracking: tracking
[0m07:32:18.730890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc7b4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc7b4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc7b4f10>]}
[0m07:32:18.753804 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m07:32:18.754288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc7b4f10>]}
[0m07:32:18.924225 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m07:32:18.931108 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:32:18.934858 [debug] [MainThread]: Parsing macros/relations.sql
[0m07:32:18.937036 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:32:18.980763 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m07:32:18.982718 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m07:32:18.986320 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:32:18.987273 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:32:18.989528 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:32:19.000152 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:32:19.001565 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:32:19.003939 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:32:19.005450 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:32:19.012153 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:32:19.016439 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:32:19.019813 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:32:19.046064 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:32:19.067878 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:32:19.086288 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:32:19.092763 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:32:19.095270 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:32:19.098462 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:32:19.110760 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:32:19.134600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:32:19.136722 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m07:32:19.149180 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:32:19.167581 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:32:19.196026 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:32:19.205215 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:32:19.210772 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:32:19.220619 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:32:19.222432 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:32:19.229290 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:32:19.235153 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:32:19.247975 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:32:19.317121 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:32:19.319807 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:32:19.323803 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:32:19.326624 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:32:19.327738 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:32:19.328935 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:32:19.330236 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:32:19.333373 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:32:19.342375 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:32:19.356217 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:32:19.357761 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:32:19.359887 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:32:19.361151 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:32:19.362583 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:32:19.365502 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:32:19.367147 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:32:19.368894 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:32:19.370758 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:32:19.375198 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:32:19.376941 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:32:19.378317 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:32:19.381373 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:32:19.383278 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:32:19.384830 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:32:19.386983 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:32:19.388713 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:32:19.401187 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m07:32:19.403003 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:32:19.404873 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:32:19.407546 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:32:19.410741 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:32:19.413556 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:32:19.415940 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m07:32:19.417897 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:32:19.421945 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m07:32:19.427249 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:32:19.432396 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:32:19.455830 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:32:19.458929 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:32:19.481072 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:32:19.488482 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:32:19.499608 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:32:19.512507 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m07:32:19.521573 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:32:19.891146 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m07:32:19.912334 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m07:32:20.000527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccad5610>]}
[0m07:32:20.015342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccb34590>]}
[0m07:32:20.016152 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:32:20.017219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccb345d0>]}
[0m07:32:20.019831 [info ] [MainThread]: 
[0m07:32:20.022973 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:32:20.027262 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m07:32:20.050874 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m07:32:20.051113 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m07:32:20.051268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:20.189817 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.14 seconds
[0m07:32:20.193741 [debug] [ThreadPool]: On list_tradekit: Close
[0m07:32:20.194907 [debug] [ThreadPool]: Acquiring new postgres connection "create_tradekit_dev_schema"
[0m07:32:20.195569 [debug] [ThreadPool]: Acquiring new postgres connection "create_tradekit_dev_schema"
[0m07:32:20.195850 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='tradekit', schema='dev_schema', identifier=None)"
[0m07:32:20.204946 [debug] [ThreadPool]: Using postgres connection "create_tradekit_dev_schema"
[0m07:32:20.205192 [debug] [ThreadPool]: On create_tradekit_dev_schema: BEGIN
[0m07:32:20.205482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:20.296793 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
[0m07:32:20.297481 [debug] [ThreadPool]: Using postgres connection "create_tradekit_dev_schema"
[0m07:32:20.297891 [debug] [ThreadPool]: On create_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_tradekit_dev_schema"} */
create schema if not exists "dev_schema"
[0m07:32:20.328926 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.03 seconds
[0m07:32:20.331263 [debug] [ThreadPool]: On create_tradekit_dev_schema: COMMIT
[0m07:32:20.331601 [debug] [ThreadPool]: Using postgres connection "create_tradekit_dev_schema"
[0m07:32:20.331985 [debug] [ThreadPool]: On create_tradekit_dev_schema: COMMIT
[0m07:32:20.341802 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m07:32:20.342516 [debug] [ThreadPool]: On create_tradekit_dev_schema: Close
[0m07:32:20.346648 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m07:32:20.359108 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m07:32:20.359352 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m07:32:20.359510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:20.452950 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
[0m07:32:20.453558 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m07:32:20.453951 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m07:32:20.512590 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.06 seconds
[0m07:32:20.515003 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m07:32:20.525292 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m07:32:20.536714 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:20.537038 [debug] [MainThread]: On master: BEGIN
[0m07:32:20.537268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:20.629808 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
[0m07:32:20.630517 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:20.630939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:32:20.827295 [debug] [MainThread]: SQL status: SELECT 34 in 0.2 seconds
[0m07:32:20.831235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc3f0910>]}
[0m07:32:20.831723 [debug] [MainThread]: On master: ROLLBACK
[0m07:32:20.842447 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:20.843098 [debug] [MainThread]: On master: BEGIN
[0m07:32:20.860687 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m07:32:20.861294 [debug] [MainThread]: On master: COMMIT
[0m07:32:20.861659 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:20.861998 [debug] [MainThread]: On master: COMMIT
[0m07:32:20.871123 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m07:32:20.871912 [debug] [MainThread]: On master: Close
[0m07:32:20.873577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:32:20.874406 [info ] [MainThread]: 
[0m07:32:20.879931 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m07:32:20.880389 [info ] [Thread-1  ]: 1 of 2 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m07:32:20.881311 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:20.881577 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m07:32:20.881791 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m07:32:20.885520 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m07:32:20.886380 [debug] [Thread-1  ]: finished collecting timing info
[0m07:32:20.886583 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m07:32:20.946705 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m07:32:20.947572 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:20.947750 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m07:32:20.947942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:32:21.074528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m07:32:21.075197 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:21.075709 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m07:32:21.134021 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.06 seconds
[0m07:32:21.145987 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:21.146227 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:32:21.157253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m07:32:21.186382 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:32:21.186642 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:21.186789 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:32:21.199034 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m07:32:21.209034 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:32:21.209276 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m07:32:21.217317 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
[0m07:32:21.220924 [debug] [Thread-1  ]: finished collecting timing info
[0m07:32:21.221491 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m07:32:21.223149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccbd76d0>]}
[0m07:32:21.223817 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.34s]
[0m07:32:21.224680 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m07:32:21.225178 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m07:32:21.225496 [info ] [Thread-1  ]: 2 of 2 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m07:32:21.226426 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.226658 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m07:32:21.226863 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m07:32:21.230409 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.230957 [debug] [Thread-1  ]: finished collecting timing info
[0m07:32:21.231151 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m07:32:21.265467 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.266394 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.266718 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m07:32:21.267077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:32:21.359171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
[0m07:32:21.359675 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.359945 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m07:32:21.385778 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m07:32:21.392256 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.392575 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:32:21.403056 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m07:32:21.407558 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:32:21.407858 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.408101 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:32:21.417678 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m07:32:21.421561 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:32:21.421862 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m07:32:21.432470 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m07:32:21.435001 [debug] [Thread-1  ]: finished collecting timing info
[0m07:32:21.435357 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m07:32:21.436302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc476c0f-9b41-49cd-ac75-77ab41f0b6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccdc0b50>]}
[0m07:32:21.436898 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m07:32:21.437638 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m07:32:21.499833 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:32:21.500433 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:21.500829 [debug] [MainThread]: On master: BEGIN
[0m07:32:21.501186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:32:21.599557 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m07:32:21.600240 [debug] [MainThread]: On master: COMMIT
[0m07:32:21.600658 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:21.601026 [debug] [MainThread]: On master: COMMIT
[0m07:32:21.607810 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m07:32:21.608425 [debug] [MainThread]: On master: Close
[0m07:32:21.609888 [info ] [MainThread]: 
[0m07:32:21.610625 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m07:32:21.611503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:21.612070 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m07:32:21.624693 [info ] [MainThread]: 
[0m07:32:21.625112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:32:21.625567 [info ] [MainThread]: 
[0m07:32:21.625970 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:32:21.626541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccaf9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccd7c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ccd7c890>]}
[0m07:32:21.626952 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 07:48:37.377271 | 2a8caaab-ed5b-4e61-baf3-1ebbd69644ad ==============================
[0m07:48:37.377323 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:48:37.379205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:48:37.379565 [debug] [MainThread]: Tracking: tracking
[0m07:48:37.421410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2888caf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2888ca390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2888ca610>]}
[0m07:48:37.474337 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:48:37.474818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288af0890>]}
[0m07:48:37.651420 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m07:48:37.655512 [debug] [MainThread]: Parsing macros/catalog.sql
[0m07:48:37.658642 [debug] [MainThread]: Parsing macros/relations.sql
[0m07:48:37.660358 [debug] [MainThread]: Parsing macros/adapters.sql
[0m07:48:37.691677 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m07:48:37.693024 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m07:48:37.695018 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:48:37.695856 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:48:37.697627 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:48:37.705883 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:48:37.706525 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:48:37.708049 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:48:37.709373 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:48:37.714133 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:48:37.717069 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:48:37.719378 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:48:37.740304 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:48:37.756934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:48:37.772838 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:48:37.779056 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:48:37.781443 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:48:37.783706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:48:37.793765 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:48:37.813524 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:48:37.815575 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m07:48:37.824227 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:48:37.837240 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:48:37.858625 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:48:37.865726 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:48:37.870270 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:48:37.877651 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:48:37.879509 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:48:37.884160 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:48:37.887074 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:48:37.895987 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:48:37.919225 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:48:37.921126 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:48:37.924272 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:48:37.926247 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:48:37.927294 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:48:37.928280 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:48:37.929097 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:48:37.930741 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:48:37.937588 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:48:37.948257 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:48:37.949527 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:48:37.951104 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:48:37.952302 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:48:37.953460 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:48:37.955014 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:48:37.956040 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:48:37.957353 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:48:37.958715 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:48:37.961596 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:48:37.963145 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:48:37.964747 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:48:37.966105 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:48:37.967402 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:48:37.968557 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:48:37.969898 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:48:37.971034 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:48:37.979446 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m07:48:37.980761 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:48:37.982153 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:48:37.984451 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:48:37.987008 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:48:37.988307 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:48:37.990180 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m07:48:37.991802 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:48:37.994991 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m07:48:37.999702 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:48:38.003151 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:48:38.022836 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:48:38.025402 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:48:38.042849 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:48:38.048650 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:48:38.057642 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:48:38.069809 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m07:48:38.077315 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:48:38.404561 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m07:48:38.419596 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m07:48:38.422945 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m07:48:38.506811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288a641d0>]}
[0m07:48:38.517549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288ba1250>]}
[0m07:48:38.518077 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:48:38.518490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2888ca450>]}
[0m07:48:38.519904 [info ] [MainThread]: 
[0m07:48:38.520723 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:48:38.521870 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m07:48:38.535130 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m07:48:38.535365 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m07:48:38.535512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:38.712033 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.18 seconds
[0m07:48:38.715558 [debug] [ThreadPool]: On list_tradekit: Close
[0m07:48:38.718201 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m07:48:38.726604 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m07:48:38.726867 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m07:48:38.727024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:38.834002 [debug] [ThreadPool]: SQL status: BEGIN in 0.11 seconds
[0m07:48:38.834639 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m07:48:38.835046 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m07:48:38.863048 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.03 seconds
[0m07:48:38.866597 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m07:48:38.880547 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m07:48:38.891180 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:38.891521 [debug] [MainThread]: On master: BEGIN
[0m07:48:38.891714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:48:38.991890 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m07:48:38.992567 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:38.992984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:48:39.104802 [debug] [MainThread]: SQL status: SELECT 35 in 0.11 seconds
[0m07:48:39.110265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288c15e50>]}
[0m07:48:39.110787 [debug] [MainThread]: On master: ROLLBACK
[0m07:48:39.121502 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:39.122285 [debug] [MainThread]: On master: BEGIN
[0m07:48:39.141037 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m07:48:39.141729 [debug] [MainThread]: On master: COMMIT
[0m07:48:39.142169 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:39.142538 [debug] [MainThread]: On master: COMMIT
[0m07:48:39.151205 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m07:48:39.152005 [debug] [MainThread]: On master: Close
[0m07:48:39.153353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:39.154098 [info ] [MainThread]: 
[0m07:48:39.159525 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m07:48:39.160074 [info ] [Thread-1  ]: 1 of 3 START sql view model dev_schema.customers ............................... [RUN]
[0m07:48:39.161062 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m07:48:39.161303 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m07:48:39.161521 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m07:48:39.163968 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m07:48:39.164520 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.164721 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m07:48:39.212770 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m07:48:39.213402 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m07:48:39.213571 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m07:48:39.213752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:48:39.316754 [debug] [Thread-1  ]: SQL status: BEGIN in 0.1 seconds
[0m07:48:39.317453 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m07:48:39.317858 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "tradekit"."dev_schema"."customers__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m07:48:39.331980 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 11:     from jaffle_shop.customers
                  ^

[0m07:48:39.332625 [debug] [Thread-1  ]: On model.jaffle_shop.customers: ROLLBACK
[0m07:48:39.341803 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.342420 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m07:48:39.343990 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 11:     from jaffle_shop.customers
                    ^
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m07:48:39.344665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288dbbb50>]}
[0m07:48:39.345527 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model dev_schema.customers ...................... [[31mERROR[0m in 0.18s]
[0m07:48:39.346440 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m07:48:39.346800 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m07:48:39.347219 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m07:48:39.348505 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.348800 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m07:48:39.349028 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m07:48:39.353807 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.354905 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.355139 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m07:48:39.384551 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.385703 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.385911 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m07:48:39.386061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:48:39.482668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.1 seconds
[0m07:48:39.483325 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.483730 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m07:48:39.507091 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
[0m07:48:39.518797 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.519072 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m07:48:39.531697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m07:48:39.538472 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.538823 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:48:39.552708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m07:48:39.584926 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:48:39.585222 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.585398 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m07:48:39.604576 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m07:48:39.614632 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m07:48:39.614895 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m07:48:39.663083 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
[0m07:48:39.666103 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.666591 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m07:48:39.667831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288c15110>]}
[0m07:48:39.668421 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.32s]
[0m07:48:39.669139 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m07:48:39.669739 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m07:48:39.670175 [info ] [Thread-1  ]: 3 of 3 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m07:48:39.671122 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.671393 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m07:48:39.671602 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m07:48:39.675419 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.676342 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.676573 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m07:48:39.681714 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.682484 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.682678 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m07:48:39.682825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:48:39.807274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m07:48:39.807902 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.808324 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m07:48:39.835426 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m07:48:39.841402 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.841659 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:48:39.855746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m07:48:39.860385 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:48:39.860694 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.860941 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m07:48:39.872706 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m07:48:39.879654 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m07:48:39.879944 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m07:48:39.892983 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m07:48:39.896058 [debug] [Thread-1  ]: finished collecting timing info
[0m07:48:39.896467 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m07:48:39.897881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a8caaab-ed5b-4e61-baf3-1ebbd69644ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288f3e190>]}
[0m07:48:39.898459 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.23s]
[0m07:48:39.899141 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m07:48:39.995731 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:48:39.996318 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:39.996699 [debug] [MainThread]: On master: BEGIN
[0m07:48:39.997050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:48:40.117525 [debug] [MainThread]: SQL status: BEGIN in 0.12 seconds
[0m07:48:40.118192 [debug] [MainThread]: On master: COMMIT
[0m07:48:40.118629 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:40.118998 [debug] [MainThread]: On master: COMMIT
[0m07:48:40.127135 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m07:48:40.127832 [debug] [MainThread]: On master: Close
[0m07:48:40.129319 [info ] [MainThread]: 
[0m07:48:40.130045 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m07:48:40.130923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:48:40.131693 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m07:48:40.143770 [info ] [MainThread]: 
[0m07:48:40.144272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:48:40.144645 [info ] [MainThread]: 
[0m07:48:40.144938 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m07:48:40.145210 [error] [MainThread]:   relation "jaffle_shop.customers" does not exist
[0m07:48:40.145468 [error] [MainThread]:   LINE 11:     from jaffle_shop.customers
[0m07:48:40.145720 [error] [MainThread]:                     ^
[0m07:48:40.145971 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/customers.sql
[0m07:48:40.146243 [info ] [MainThread]: 
[0m07:48:40.146514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:48:40.146877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288f34d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288f16dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa288f16c50>]}
[0m07:48:40.147154 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 13:35:42.907242 | f6ea4991-d399-4858-b11f-689b69b48497 ==============================
[0m13:35:42.907290 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:35:42.909093 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:35:42.909410 [debug] [MainThread]: Tracking: tracking
[0m13:35:42.978999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b09bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b09b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b09b490>]}
[0m13:35:43.218187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:43.218438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:43.227278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b0a1210>]}
[0m13:35:43.238365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b23c590>]}
[0m13:35:43.238882 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:35:43.239351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b23cd10>]}
[0m13:35:43.240877 [info ] [MainThread]: 
[0m13:35:43.241629 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:35:43.242794 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m13:35:43.256428 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m13:35:43.256689 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m13:35:43.256845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:43.457297 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.2 seconds
[0m13:35:43.460805 [debug] [ThreadPool]: On list_tradekit: Close
[0m13:35:43.463286 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m13:35:43.470870 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:35:43.471101 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m13:35:43.471256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:43.627775 [debug] [ThreadPool]: SQL status: BEGIN in 0.16 seconds
[0m13:35:43.628408 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:35:43.628828 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m13:35:43.655406 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.03 seconds
[0m13:35:43.660757 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m13:35:43.678369 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m13:35:43.689950 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:43.690184 [debug] [MainThread]: On master: BEGIN
[0m13:35:43.690335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:43.835418 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
[0m13:35:43.836392 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:43.836810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:35:43.944776 [debug] [MainThread]: SQL status: SELECT 35 in 0.11 seconds
[0m13:35:43.949774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b0bd450>]}
[0m13:35:43.950298 [debug] [MainThread]: On master: ROLLBACK
[0m13:35:43.975513 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:43.976353 [debug] [MainThread]: On master: BEGIN
[0m13:35:44.015862 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m13:35:44.016555 [debug] [MainThread]: On master: COMMIT
[0m13:35:44.017003 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:44.017381 [debug] [MainThread]: On master: COMMIT
[0m13:35:44.035200 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m13:35:44.035999 [debug] [MainThread]: On master: Close
[0m13:35:44.037373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:44.038123 [info ] [MainThread]: 
[0m13:35:44.050235 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m13:35:44.051013 [info ] [Thread-1  ]: 1 of 3 START sql view model dev_schema.customers ............................... [RUN]
[0m13:35:44.054411 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m13:35:44.054758 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m13:35:44.055037 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m13:35:44.057885 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:35:44.061567 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:44.062199 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m13:35:44.115976 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:35:44.116877 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:35:44.117076 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m13:35:44.117227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:44.287332 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m13:35:44.287983 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:35:44.288411 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "tradekit"."dev_schema"."customers__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:35:44.315614 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "jaffle_shop.customers" does not exist
LINE 11:     from jaffle_shop.customers
                  ^

[0m13:35:44.316245 [debug] [Thread-1  ]: On model.jaffle_shop.customers: ROLLBACK
[0m13:35:44.336067 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:44.336694 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m13:35:44.338085 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  relation "jaffle_shop.customers" does not exist
  LINE 11:     from jaffle_shop.customers
                    ^
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m13:35:44.338748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b2c22d0>]}
[0m13:35:44.339613 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model dev_schema.customers ...................... [[31mERROR[0m in 0.29s]
[0m13:35:44.340543 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m13:35:44.340930 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:35:44.341327 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m13:35:44.342466 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.342954 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:35:44.343186 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m13:35:44.347051 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.349888 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:44.350431 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:35:44.379371 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.380610 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.380830 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:35:44.380979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:44.543366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m13:35:44.544020 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.544452 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:35:44.575355 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
[0m13:35:44.588045 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.588292 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:35:44.612519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m13:35:44.618977 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.619269 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:35:44.647665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
[0m13:35:44.681595 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:35:44.681871 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.682047 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:35:44.708925 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:35:44.720187 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:35:44.720429 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m13:35:44.763354 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m13:35:44.766415 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:44.766920 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:35:44.768142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b49add0>]}
[0m13:35:44.768723 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.43s]
[0m13:35:44.769911 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:35:44.770635 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:35:44.771057 [info ] [Thread-1  ]: 3 of 3 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m13:35:44.772006 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.772254 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:35:44.772460 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m13:35:44.776079 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.777003 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:44.777255 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:35:44.782382 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.783168 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.783369 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:35:44.783516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:44.944801 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m13:35:44.945443 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.945863 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m13:35:44.979616 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m13:35:44.986083 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:44.986443 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:35:45.011469 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m13:35:45.016193 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:35:45.016558 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:45.016815 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:35:45.047602 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:35:45.053315 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:35:45.053639 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m13:35:45.075905 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
[0m13:35:45.079308 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:45.079826 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:35:45.080865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ea4991-d399-4858-b11f-689b69b48497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b49aa10>]}
[0m13:35:45.081440 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.31s]
[0m13:35:45.082152 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:35:45.093831 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:35:45.094432 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:45.094819 [debug] [MainThread]: On master: BEGIN
[0m13:35:45.095172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:45.263354 [debug] [MainThread]: SQL status: BEGIN in 0.17 seconds
[0m13:35:45.264011 [debug] [MainThread]: On master: COMMIT
[0m13:35:45.264458 [debug] [MainThread]: Using postgres connection "master"
[0m13:35:45.264828 [debug] [MainThread]: On master: COMMIT
[0m13:35:45.287183 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m13:35:45.287922 [debug] [MainThread]: On master: Close
[0m13:35:45.289546 [info ] [MainThread]: 
[0m13:35:45.290343 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m13:35:45.291349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:45.291815 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:35:45.304150 [info ] [MainThread]: 
[0m13:35:45.304595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:35:45.305016 [info ] [MainThread]: 
[0m13:35:45.305367 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m13:35:45.305658 [error] [MainThread]:   relation "jaffle_shop.customers" does not exist
[0m13:35:45.305926 [error] [MainThread]:   LINE 11:     from jaffle_shop.customers
[0m13:35:45.306186 [error] [MainThread]:                     ^
[0m13:35:45.306441 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/customers.sql
[0m13:35:45.306713 [info ] [MainThread]: 
[0m13:35:45.306990 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:35:45.307357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b49a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b364690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20b364390>]}
[0m13:35:45.307655 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 13:40:16.721520 | f111b934-f4ab-448c-b0ae-c6deb57a1071 ==============================
[0m13:40:16.721614 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:40:16.722833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:40:16.723116 [debug] [MainThread]: Tracking: tracking
[0m13:40:16.749426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef080da590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef080da510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef080da5d0>]}
[0m13:40:17.011994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:17.012570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:17.025221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0474bed0>]}
[0m13:40:17.034125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0827b050>]}
[0m13:40:17.034492 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:40:17.034795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0827b890>]}
[0m13:40:17.036135 [info ] [MainThread]: 
[0m13:40:17.036828 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:40:17.037905 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m13:40:17.051327 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m13:40:17.051567 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m13:40:17.051721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:17.217022 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.17 seconds
[0m13:40:17.220649 [debug] [ThreadPool]: On list_tradekit: Close
[0m13:40:17.223747 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m13:40:17.231833 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:40:17.232070 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m13:40:17.232230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:17.371250 [debug] [ThreadPool]: SQL status: BEGIN in 0.14 seconds
[0m13:40:17.371889 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:40:17.372320 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m13:40:17.402534 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.03 seconds
[0m13:40:17.405791 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m13:40:17.427117 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m13:40:17.437703 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:17.438048 [debug] [MainThread]: On master: BEGIN
[0m13:40:17.438248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:17.624726 [debug] [MainThread]: SQL status: BEGIN in 0.19 seconds
[0m13:40:17.625383 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:17.625828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:17.749209 [debug] [MainThread]: SQL status: SELECT 35 in 0.12 seconds
[0m13:40:17.754145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef082a2050>]}
[0m13:40:17.754644 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:17.778662 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:17.779322 [debug] [MainThread]: On master: BEGIN
[0m13:40:17.839209 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m13:40:17.839909 [debug] [MainThread]: On master: COMMIT
[0m13:40:17.840373 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:17.840761 [debug] [MainThread]: On master: COMMIT
[0m13:40:17.860462 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m13:40:17.861183 [debug] [MainThread]: On master: Close
[0m13:40:17.862833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:17.864234 [info ] [MainThread]: 
[0m13:40:17.869833 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m13:40:17.870217 [info ] [Thread-1  ]: 1 of 3 START sql view model dev_schema.customers ............................... [RUN]
[0m13:40:17.871849 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m13:40:17.872085 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m13:40:17.872270 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m13:40:17.874310 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:40:17.875261 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:17.875480 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m13:40:17.927053 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:40:17.927877 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:40:17.928063 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m13:40:17.928208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:18.078852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m13:40:18.079584 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:40:18.080008 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "tradekit"."dev_schema"."customers__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:40:18.089566 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 7:         id as customer_id,
                ^

[0m13:40:18.090633 [debug] [Thread-1  ]: On model.jaffle_shop.customers: ROLLBACK
[0m13:40:18.103598 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:18.105302 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m13:40:18.107807 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "id" does not exist
  LINE 7:         id as customer_id,
                  ^
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m13:40:18.109374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef082f4f90>]}
[0m13:40:18.111220 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model dev_schema.customers ...................... [[31mERROR[0m in 0.24s]
[0m13:40:18.113036 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m13:40:18.113447 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:40:18.114130 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m13:40:18.114893 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.115087 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:40:18.115260 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m13:40:18.118897 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.119808 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:18.120037 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:40:18.147203 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.148522 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.148852 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:40:18.149013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:18.303243 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m13:40:18.303870 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.304274 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:40:18.335007 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
[0m13:40:18.346796 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.347049 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:40:18.360649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m13:40:18.370190 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.370655 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:40:18.406965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.04 seconds
[0m13:40:18.438360 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:40:18.438613 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.438768 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:40:18.461901 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m13:40:18.473486 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:40:18.473742 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m13:40:18.526995 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
[0m13:40:18.530059 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:18.530573 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:40:18.532334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef08605510>]}
[0m13:40:18.533034 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.42s]
[0m13:40:18.533775 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:40:18.534343 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:40:18.534656 [info ] [Thread-1  ]: 3 of 3 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m13:40:18.535487 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.535712 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:40:18.535917 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m13:40:18.539496 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.540271 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:18.540486 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:40:18.545689 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.546545 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.546747 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:40:18.546901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:40:18.701517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m13:40:18.701966 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.702298 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m13:40:18.733497 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m13:40:18.738989 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.739379 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:40:18.765606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
[0m13:40:18.770227 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:40:18.770573 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.770941 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:40:18.797296 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:40:18.803006 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:40:18.803332 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m13:40:18.825590 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
[0m13:40:18.828570 [debug] [Thread-1  ]: finished collecting timing info
[0m13:40:18.829069 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:40:18.830178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f111b934-f4ab-448c-b0ae-c6deb57a1071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef085d9410>]}
[0m13:40:18.830776 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.30s]
[0m13:40:18.831555 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:40:18.898986 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:40:18.899824 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:18.900144 [debug] [MainThread]: On master: BEGIN
[0m13:40:18.900327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:19.066331 [debug] [MainThread]: SQL status: BEGIN in 0.17 seconds
[0m13:40:19.067451 [debug] [MainThread]: On master: COMMIT
[0m13:40:19.068205 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:19.068884 [debug] [MainThread]: On master: COMMIT
[0m13:40:19.093429 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m13:40:19.093969 [debug] [MainThread]: On master: Close
[0m13:40:19.095143 [info ] [MainThread]: 
[0m13:40:19.095758 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m13:40:19.096394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:19.096678 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:40:19.110739 [info ] [MainThread]: 
[0m13:40:19.111121 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:19.111525 [info ] [MainThread]: 
[0m13:40:19.111899 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m13:40:19.112240 [error] [MainThread]:   column "id" does not exist
[0m13:40:19.112525 [error] [MainThread]:   LINE 7:         id as customer_id,
[0m13:40:19.112794 [error] [MainThread]:                   ^
[0m13:40:19.113059 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/customers.sql
[0m13:40:19.113342 [info ] [MainThread]: 
[0m13:40:19.113629 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:40:19.113988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef08601490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef083b2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef085def50>]}
[0m13:40:19.114366 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 13:43:11.035574 | 96fa3ac2-5441-4f23-b70e-ce909bc9a743 ==============================
[0m13:43:11.035646 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:43:11.037057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:11.037408 [debug] [MainThread]: Tracking: tracking
[0m13:43:11.064867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcef7f4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcef7f4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcef7f4490>]}
[0m13:43:11.287189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:11.287430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:11.295746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcef7faed0>]}
[0m13:43:11.306258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefa94b90>]}
[0m13:43:11.306621 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:43:11.306947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefa94950>]}
[0m13:43:11.308476 [info ] [MainThread]: 
[0m13:43:11.309777 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:43:11.311413 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m13:43:11.326003 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m13:43:11.326222 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m13:43:11.326374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:11.534590 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.21 seconds
[0m13:43:11.538294 [debug] [ThreadPool]: On list_tradekit: Close
[0m13:43:11.541057 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m13:43:11.549311 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:43:11.549576 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m13:43:11.549740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:11.686640 [debug] [ThreadPool]: SQL status: BEGIN in 0.14 seconds
[0m13:43:11.687013 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m13:43:11.687302 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m13:43:11.712268 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.02 seconds
[0m13:43:11.715493 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m13:43:11.732323 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m13:43:11.739373 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.739661 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.739839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:11.896620 [debug] [MainThread]: SQL status: BEGIN in 0.16 seconds
[0m13:43:11.897089 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.897425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:43:11.968225 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m13:43:11.974599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcef80b250>]}
[0m13:43:11.975178 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:11.996999 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.997884 [debug] [MainThread]: On master: BEGIN
[0m13:43:12.037741 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m13:43:12.038424 [debug] [MainThread]: On master: COMMIT
[0m13:43:12.038876 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:12.039263 [debug] [MainThread]: On master: COMMIT
[0m13:43:12.047202 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m13:43:12.048260 [debug] [MainThread]: On master: Close
[0m13:43:12.050808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:12.052090 [info ] [MainThread]: 
[0m13:43:12.055636 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m13:43:12.056085 [info ] [Thread-1  ]: 1 of 3 START sql view model dev_schema.customers ............................... [RUN]
[0m13:43:12.057150 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m13:43:12.057608 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m13:43:12.057879 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m13:43:12.061947 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:43:12.063313 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:12.063583 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m13:43:12.118853 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:43:12.119848 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:43:12.120057 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m13:43:12.120203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:12.304676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m13:43:12.305336 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:43:12.305782 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  create view "tradekit"."dev_schema"."customers__dbt_tmp" as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:43:12.352908 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.05 seconds
[0m13:43:12.364554 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:43:12.364839 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers__dbt_tmp" rename to "customers"
[0m13:43:12.392665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
[0m13:43:12.426579 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m13:43:12.426836 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:43:12.426998 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m13:43:12.457307 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:43:12.466103 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m13:43:12.466356 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "tradekit"."dev_schema"."customers__dbt_backup" cascade
[0m13:43:12.488553 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
[0m13:43:12.491656 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:12.492172 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m13:43:12.493426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefc31990>]}
[0m13:43:12.494022 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dev_schema.customers .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:43:12.494844 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m13:43:12.495300 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m13:43:12.495838 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m13:43:12.496791 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.497036 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m13:43:12.497252 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m13:43:12.501311 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.502274 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:12.502506 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m13:43:12.539841 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.541073 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.541275 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m13:43:12.541422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:12.712588 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m13:43:12.713174 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.713581 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:43:12.741173 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
[0m13:43:12.749715 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.750010 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:43:12.774146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m13:43:12.780779 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.781183 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:43:12.809496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
[0m13:43:12.823498 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:43:12.823749 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.823913 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m13:43:12.852531 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:43:12.858027 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m13:43:12.858378 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m13:43:12.888719 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m13:43:12.891790 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:12.892343 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m13:43:12.893556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefa6f7d0>]}
[0m13:43:12.894157 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.40s]
[0m13:43:12.894883 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m13:43:12.895523 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m13:43:12.895970 [info ] [Thread-1  ]: 3 of 3 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m13:43:12.896883 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:12.897132 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m13:43:12.897345 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m13:43:12.901196 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m13:43:12.902211 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:12.902434 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m13:43:12.907623 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m13:43:12.908560 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:12.908849 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m13:43:12.909019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:13.036910 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m13:43:13.037571 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:13.038011 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m13:43:13.068706 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m13:43:13.075307 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:13.075644 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:43:13.100870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m13:43:13.105451 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:43:13.105779 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:13.106034 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m13:43:13.132891 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:43:13.138626 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m13:43:13.138981 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m13:43:13.160828 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
[0m13:43:13.163881 [debug] [Thread-1  ]: finished collecting timing info
[0m13:43:13.164404 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m13:43:13.165713 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fa3ac2-5441-4f23-b70e-ce909bc9a743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefbb6510>]}
[0m13:43:13.166315 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.27s]
[0m13:43:13.167075 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m13:43:13.197717 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:43:13.198334 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:13.198742 [debug] [MainThread]: On master: BEGIN
[0m13:43:13.199116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:13.352528 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
[0m13:43:13.353226 [debug] [MainThread]: On master: COMMIT
[0m13:43:13.353705 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:13.354096 [debug] [MainThread]: On master: COMMIT
[0m13:43:13.376676 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m13:43:13.377371 [debug] [MainThread]: On master: Close
[0m13:43:13.378856 [info ] [MainThread]: 
[0m13:43:13.379599 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m13:43:13.380334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:13.380738 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m13:43:13.395386 [info ] [MainThread]: 
[0m13:43:13.396053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:13.396569 [info ] [MainThread]: 
[0m13:43:13.396992 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:43:13.397447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefa60950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefca1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcefcd2210>]}
[0m13:43:13.397782 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:41:54.489056 | 5e63eeed-aa78-4b3f-b10f-7a3da3c0df23 ==============================
[0m17:41:54.489105 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:41:54.491365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:41:54.491950 [debug] [MainThread]: Tracking: tracking
[0m17:41:54.564634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29e79eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29e91d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29e79ecd0>]}
[0m17:41:54.698628 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:41:54.699039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eadab90>]}
[0m17:41:54.882833 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m17:41:54.891507 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:41:54.896883 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:41:54.899760 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:41:54.966112 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m17:41:54.967761 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:41:54.970383 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:41:54.971252 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:41:54.973466 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:41:54.982362 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:41:54.983033 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:41:54.984619 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:41:54.986006 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:41:54.991764 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:41:54.994792 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:41:54.996885 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:41:55.020344 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:41:55.037303 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:41:55.052848 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:41:55.058584 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:41:55.061303 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:41:55.063594 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:41:55.074109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:41:55.094027 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:41:55.095982 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:41:55.104826 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:41:55.119031 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:41:55.140986 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:41:55.147985 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:41:55.152749 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:41:55.159645 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:41:55.161404 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:41:55.165575 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:41:55.168395 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:41:55.177387 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:41:55.200326 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:41:55.202194 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:41:55.205200 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:41:55.207104 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:41:55.208163 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:41:55.209157 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:41:55.210089 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:41:55.211793 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:41:55.218267 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:41:55.229134 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:41:55.230334 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:41:55.231882 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:41:55.233093 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:41:55.234259 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:41:55.235838 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:41:55.236878 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:41:55.238189 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:41:55.239565 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:41:55.242455 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:41:55.244003 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:41:55.245571 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:41:55.246932 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:41:55.248244 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:41:55.249403 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:41:55.250761 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:41:55.252177 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:41:55.263755 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:41:55.265311 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:41:55.266512 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:41:55.268770 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:41:55.271322 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:41:55.272650 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:41:55.274557 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:41:55.275895 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:41:55.278690 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:41:55.283070 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:41:55.286473 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:41:55.305225 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:41:55.307795 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:41:55.327776 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:41:55.333676 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:41:55.342936 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:41:55.355762 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:41:55.363602 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:41:55.702657 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m17:41:55.717175 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m17:41:55.720479 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m17:41:55.807539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb694d0>]}
[0m17:41:55.823644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb4e3d0>]}
[0m17:41:55.824231 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:41:55.824713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb4e790>]}
[0m17:41:55.826610 [info ] [MainThread]: 
[0m17:41:55.827539 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:41:55.828938 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m17:41:55.842698 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m17:41:55.842965 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m17:41:55.843117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:56.119722 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.28 seconds
[0m17:41:56.123316 [debug] [ThreadPool]: On list_tradekit: Close
[0m17:41:56.125949 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:41:56.134314 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:41:56.134587 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:41:56.134752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:56.251045 [debug] [ThreadPool]: SQL status: BEGIN in 0.12 seconds
[0m17:41:56.251677 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:41:56.252087 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:41:56.279105 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.03 seconds
[0m17:41:56.280958 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:41:56.302788 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:41:56.315647 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:56.317634 [debug] [MainThread]: On master: BEGIN
[0m17:41:56.318753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:56.439347 [debug] [MainThread]: SQL status: BEGIN in 0.12 seconds
[0m17:41:56.439811 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:56.440108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:41:56.508080 [debug] [MainThread]: SQL status: SELECT 37 in 0.07 seconds
[0m17:41:56.513177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb675d0>]}
[0m17:41:56.513682 [debug] [MainThread]: On master: ROLLBACK
[0m17:41:56.531016 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:56.531682 [debug] [MainThread]: On master: BEGIN
[0m17:41:56.570806 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:41:56.571497 [debug] [MainThread]: On master: COMMIT
[0m17:41:56.571962 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:56.572355 [debug] [MainThread]: On master: COMMIT
[0m17:41:56.591019 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:41:56.591713 [debug] [MainThread]: On master: Close
[0m17:41:56.593111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:56.593874 [info ] [MainThread]: 
[0m17:41:56.606007 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m17:41:56.606831 [info ] [Thread-1  ]: 1 of 3 START sql table model dev_schema.customers .............................. [RUN]
[0m17:41:56.608545 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m17:41:56.609009 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m17:41:56.609441 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m17:41:56.612977 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:41:56.614654 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:56.615131 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m17:41:56.673060 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:41:56.673897 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.674082 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m17:41:56.674225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:56.798858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m17:41:56.799523 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.799960 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "tradekit"."dev_schema"."customers__dbt_tmp"
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m17:41:56.862839 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.06 seconds
[0m17:41:56.875260 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.875551 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers" rename to "customers__dbt_backup"
[0m17:41:56.896741 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:41:56.902927 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.903249 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers__dbt_tmp" rename to "customers"
[0m17:41:56.924131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:41:56.956346 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:41:56.956616 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.956772 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:41:56.978855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m17:41:56.989345 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:41:56.989619 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "tradekit"."dev_schema"."customers__dbt_backup" cascade
[0m17:41:57.019259 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
[0m17:41:57.022305 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:57.022926 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m17:41:57.024912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29ee99350>]}
[0m17:41:57.025641 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dev_schema.customers ......................... [[32mSELECT 100[0m in 0.42s]
[0m17:41:57.026581 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m17:41:57.026929 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_first_dbt_model
[0m17:41:57.027395 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.my_first_dbt_model ..................... [RUN]
[0m17:41:57.028321 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.028574 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m17:41:57.028791 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_first_dbt_model
[0m17:41:57.032316 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.033106 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:57.033321 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m17:41:57.038602 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.039405 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.039646 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m17:41:57.039801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:57.282596 [debug] [Thread-1  ]: SQL status: BEGIN in 0.24 seconds
[0m17:41:57.283254 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.283685 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:41:57.310863 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
[0m17:41:57.317813 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.318135 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:41:57.343246 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:41:57.349771 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.350091 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "tradekit"."dev_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:41:57.371226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:41:57.377054 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m17:41:57.377400 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.377654 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m17:41:57.405948 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m17:41:57.411498 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m17:41:57.411809 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "tradekit"."dev_schema"."my_first_dbt_model__dbt_backup" cascade
[0m17:41:57.450872 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m17:41:57.453876 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:57.454391 [debug] [Thread-1  ]: On model.jaffle_shop.my_first_dbt_model: Close
[0m17:41:57.455609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29ee52850>]}
[0m17:41:57.456216 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.43s]
[0m17:41:57.456977 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m17:41:57.457752 [debug] [Thread-1  ]: Began running node model.jaffle_shop.my_second_dbt_model
[0m17:41:57.458199 [info ] [Thread-1  ]: 3 of 3 START sql view model dev_schema.my_second_dbt_model ..................... [RUN]
[0m17:41:57.459078 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.459320 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m17:41:57.459529 [debug] [Thread-1  ]: Compiling model.jaffle_shop.my_second_dbt_model
[0m17:41:57.464409 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.465351 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:57.465591 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m17:41:57.492368 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.493310 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.493563 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m17:41:57.493717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:57.634857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:41:57.635515 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.635944 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "tradekit"."dev_schema"."my_first_dbt_model"
where id = 1
  );
[0m17:41:57.666683 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.03 seconds
[0m17:41:57.673136 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.673406 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "tradekit"."dev_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:41:57.702866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.03 seconds
[0m17:41:57.707604 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m17:41:57.707923 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.708173 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m17:41:57.736627 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m17:41:57.740269 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m17:41:57.740549 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "tradekit"."dev_schema"."my_second_dbt_model__dbt_backup" cascade
[0m17:41:57.770957 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.03 seconds
[0m17:41:57.774051 [debug] [Thread-1  ]: finished collecting timing info
[0m17:41:57.774567 [debug] [Thread-1  ]: On model.jaffle_shop.my_second_dbt_model: Close
[0m17:41:57.775792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63eeed-aa78-4b3f-b10f-7a3da3c0df23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29ee8ff90>]}
[0m17:41:57.776406 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dev_schema.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.32s]
[0m17:41:57.777256 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m17:41:57.843682 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:41:57.844136 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:57.844426 [debug] [MainThread]: On master: BEGIN
[0m17:41:57.844710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:57.995161 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
[0m17:41:57.995844 [debug] [MainThread]: On master: COMMIT
[0m17:41:57.996274 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:57.996653 [debug] [MainThread]: On master: COMMIT
[0m17:41:58.014902 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:41:58.015600 [debug] [MainThread]: On master: Close
[0m17:41:58.017092 [info ] [MainThread]: 
[0m17:41:58.017847 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m17:41:58.018595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:58.019177 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m17:41:58.029870 [info ] [MainThread]: 
[0m17:41:58.030291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:58.030727 [info ] [MainThread]: 
[0m17:41:58.031080 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:41:58.031472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb4ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29ef2d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29eb9d8d0>]}
[0m17:41:58.031761 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:43:09.696724 | 7500ba29-e0c2-4393-b7d5-5676b300010d ==============================
[0m17:43:09.696760 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:43:09.698121 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:43:09.698534 [debug] [MainThread]: Tracking: tracking
[0m17:43:09.724920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c58bacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c58baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c58bad90>]}
[0m17:43:09.793490 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:43:09.793942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5adbe10>]}
[0m17:43:09.915528 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m17:43:09.920213 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:43:09.923052 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:43:09.924687 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:43:09.955663 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m17:43:09.956994 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:43:09.959095 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:43:09.959875 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:43:09.961827 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:43:09.969950 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:43:09.970533 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:43:09.972065 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:43:09.973375 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:43:09.978281 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:43:09.981360 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:43:09.983454 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:43:10.003799 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:43:10.021308 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:43:10.037195 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:43:10.042961 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:43:10.045184 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:43:10.047792 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:43:10.058411 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:43:10.078201 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:43:10.080133 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:43:10.088820 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:43:10.102063 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:43:10.123286 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:43:10.130417 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:43:10.134931 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:43:10.141967 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:43:10.143665 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:43:10.147974 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:43:10.150879 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:43:10.159645 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:43:10.182673 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:43:10.184550 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:43:10.187828 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:43:10.189814 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:43:10.190898 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:43:10.191904 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:43:10.192749 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:43:10.194422 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:43:10.201247 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:43:10.211894 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:43:10.212951 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:43:10.214474 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:43:10.215675 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:43:10.217207 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:43:10.222116 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:43:10.223284 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:43:10.224645 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:43:10.226015 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:43:10.228926 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:43:10.230474 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:43:10.232791 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:43:10.234776 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:43:10.236196 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:43:10.238205 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:43:10.239717 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:43:10.240913 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:43:10.250061 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:43:10.251487 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:43:10.252672 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:43:10.255203 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:43:10.257823 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:43:10.259213 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:43:10.261095 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:43:10.262414 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:43:10.265543 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:43:10.269729 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:43:10.273065 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:43:10.292281 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:43:10.294868 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:43:10.312258 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:43:10.318112 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:43:10.327348 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:43:10.340302 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:43:10.348091 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:43:10.676540 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m17:43:10.743928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5a26fd0>]}
[0m17:43:10.753701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5accfd0>]}
[0m17:43:10.754134 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:43:10.754436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5a6b210>]}
[0m17:43:10.755561 [info ] [MainThread]: 
[0m17:43:10.756339 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:43:10.757309 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m17:43:10.772393 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m17:43:10.772681 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m17:43:10.772840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:10.955423 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.18 seconds
[0m17:43:10.959007 [debug] [ThreadPool]: On list_tradekit: Close
[0m17:43:10.961285 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:43:10.969915 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:43:10.970173 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:43:10.970335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:11.105538 [debug] [ThreadPool]: SQL status: BEGIN in 0.14 seconds
[0m17:43:11.106191 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:43:11.106614 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:43:11.140508 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.03 seconds
[0m17:43:11.144593 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:43:11.164715 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:43:11.175211 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:11.175505 [debug] [MainThread]: On master: BEGIN
[0m17:43:11.175736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:11.864791 [debug] [MainThread]: SQL status: BEGIN in 0.69 seconds
[0m17:43:11.865431 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:11.865874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:43:12.295249 [debug] [MainThread]: SQL status: SELECT 35 in 0.43 seconds
[0m17:43:12.297463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c53c9ad0>]}
[0m17:43:12.297811 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:12.316871 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:12.317693 [debug] [MainThread]: On master: BEGIN
[0m17:43:12.352832 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:43:12.353502 [debug] [MainThread]: On master: COMMIT
[0m17:43:12.353928 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:12.354311 [debug] [MainThread]: On master: COMMIT
[0m17:43:12.372812 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:43:12.373527 [debug] [MainThread]: On master: Close
[0m17:43:12.375074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:12.375865 [info ] [MainThread]: 
[0m17:43:12.388218 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m17:43:12.389022 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_schema.customers .............................. [RUN]
[0m17:43:12.390895 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m17:43:12.391394 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m17:43:12.391822 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m17:43:12.395329 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:43:12.396378 [debug] [Thread-1  ]: finished collecting timing info
[0m17:43:12.396646 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m17:43:12.453529 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:43:12.454482 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:12.454677 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m17:43:12.454827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:43:13.380812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.93 seconds
[0m17:43:13.381574 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:13.381987 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "tradekit"."dev_schema"."customers__dbt_tmp"
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m17:43:13.436570 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.05 seconds
[0m17:43:13.446103 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:13.446358 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers" rename to "customers__dbt_backup"
[0m17:43:13.465832 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:43:13.471599 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:13.471849 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers__dbt_tmp" rename to "customers"
[0m17:43:13.700739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.23 seconds
[0m17:43:13.728906 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:43:13.729184 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:13.729342 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:43:13.756884 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m17:43:13.767254 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:43:13.767485 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "tradekit"."dev_schema"."customers__dbt_backup" cascade
[0m17:43:13.800805 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m17:43:13.803913 [debug] [Thread-1  ]: finished collecting timing info
[0m17:43:13.804424 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m17:43:13.805672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7500ba29-e0c2-4393-b7d5-5676b300010d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5d9b690>]}
[0m17:43:13.806276 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_schema.customers ......................... [[32mSELECT 100[0m in 1.42s]
[0m17:43:13.807034 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m17:43:13.821475 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:43:13.822069 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:13.822472 [debug] [MainThread]: On master: BEGIN
[0m17:43:13.822836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:14.224669 [debug] [MainThread]: SQL status: BEGIN in 0.4 seconds
[0m17:43:14.225513 [debug] [MainThread]: On master: COMMIT
[0m17:43:14.225935 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:14.226528 [debug] [MainThread]: On master: COMMIT
[0m17:43:14.252146 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
[0m17:43:14.252803 [debug] [MainThread]: On master: Close
[0m17:43:14.254263 [info ] [MainThread]: 
[0m17:43:14.255005 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m17:43:14.255771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:14.256193 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:43:14.266510 [info ] [MainThread]: 
[0m17:43:14.266891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:14.267328 [info ] [MainThread]: 
[0m17:43:14.267691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:43:14.268226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5d97b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5d97750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6c5d97710>]}
[0m17:43:14.268513 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:50:44.277508 | c5df44b3-4368-4fd7-884b-c3c7243714b5 ==============================
[0m17:50:44.277542 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:50:44.278978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:50:44.279493 [debug] [MainThread]: Tracking: tracking
[0m17:50:44.303791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca88ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca88a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca88a510>]}
[0m17:50:44.536935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:50:44.537374 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_orders.sql
[0m17:50:44.537627 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_customers.sql
[0m17:50:44.537931 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m17:50:44.554726 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m17:50:44.572081 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m17:50:44.575829 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m17:50:44.598933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2cab011d0>]}
[0m17:50:44.608300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2caa40e90>]}
[0m17:50:44.608704 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:50:44.609041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2caa40f10>]}
[0m17:50:44.610560 [info ] [MainThread]: 
[0m17:50:44.611634 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:50:44.612885 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m17:50:44.627951 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m17:50:44.628205 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m17:50:44.628364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:44.821582 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.19 seconds
[0m17:50:44.825729 [debug] [ThreadPool]: On list_tradekit: Close
[0m17:50:44.828284 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:50:44.836409 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:50:44.836673 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:50:44.836837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:44.966580 [debug] [ThreadPool]: SQL status: BEGIN in 0.13 seconds
[0m17:50:44.967233 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:50:44.967671 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:50:44.991931 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.02 seconds
[0m17:50:44.995457 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:50:45.014347 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:50:45.024306 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:45.024594 [debug] [MainThread]: On master: BEGIN
[0m17:50:45.024797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:45.158459 [debug] [MainThread]: SQL status: BEGIN in 0.13 seconds
[0m17:50:45.159282 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:45.159753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:45.241941 [debug] [MainThread]: SQL status: SELECT 35 in 0.08 seconds
[0m17:50:45.247195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca94ff10>]}
[0m17:50:45.247737 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:45.267269 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:45.267922 [debug] [MainThread]: On master: BEGIN
[0m17:50:45.306565 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:50:45.307275 [debug] [MainThread]: On master: COMMIT
[0m17:50:45.307720 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:45.308105 [debug] [MainThread]: On master: COMMIT
[0m17:50:45.326581 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:50:45.327404 [debug] [MainThread]: On master: Close
[0m17:50:45.328977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:45.329767 [info ] [MainThread]: 
[0m17:50:45.334837 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m17:50:45.335380 [info ] [Thread-1  ]: 1 of 3 START sql table model dev_schema.stg_customers .......................... [RUN]
[0m17:50:45.336382 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m17:50:45.336628 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m17:50:45.336846 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m17:50:45.339302 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:50:45.339846 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:45.340067 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m17:50:45.394882 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:50:45.395527 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:50:45.395702 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m17:50:45.395845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:45.534617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:50:45.535264 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:50:45.535692 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "tradekit"."dev_schema"."stg_customers__dbt_tmp"
  as (
    select
    id as customer_id,
    first_name,
    last_name

from jaffle_shop_customers
  );
  
[0m17:50:45.558619 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "jaffle_shop_customers" does not exist
LINE 13: from jaffle_shop_customers
              ^

[0m17:50:45.559364 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m17:50:45.578670 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:45.579102 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m17:50:45.580139 [debug] [Thread-1  ]: Database Error in model stg_customers (models/stg_customers.sql)
  relation "jaffle_shop_customers" does not exist
  LINE 13: from jaffle_shop_customers
                ^
  compiled Code at target/run/jaffle_shop/models/stg_customers.sql
[0m17:50:45.580829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2caa67190>]}
[0m17:50:45.581452 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model dev_schema.stg_customers ................. [[31mERROR[0m in 0.24s]
[0m17:50:45.582059 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m17:50:45.582363 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m17:50:45.582676 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.stg_orders ............................. [RUN]
[0m17:50:45.583593 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m17:50:45.583819 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m17:50:45.584025 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m17:50:45.587373 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:50:45.588112 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:45.588324 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m17:50:45.593343 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:50:45.593895 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:50:45.594069 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m17:50:45.594214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:45.742947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m17:50:45.743686 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:50:45.744101 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "tradekit"."dev_schema"."stg_orders__dbt_tmp"
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from jaffle_shop_orders
  );
  
[0m17:50:45.762550 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "jaffle_shop_orders" does not exist
LINE 14: from jaffle_shop_orders
              ^

[0m17:50:45.763181 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: ROLLBACK
[0m17:50:45.783033 [debug] [Thread-1  ]: finished collecting timing info
[0m17:50:45.783654 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m17:50:45.785038 [debug] [Thread-1  ]: Database Error in model stg_orders (models/stg_orders.sql)
  relation "jaffle_shop_orders" does not exist
  LINE 14: from jaffle_shop_orders
                ^
  compiled Code at target/run/jaffle_shop/models/stg_orders.sql
[0m17:50:45.785674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5df44b3-4368-4fd7-884b-c3c7243714b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2cab01290>]}
[0m17:50:45.786516 [error] [Thread-1  ]: 2 of 3 ERROR creating sql table model dev_schema.stg_orders .................... [[31mERROR[0m in 0.20s]
[0m17:50:45.787421 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m17:50:45.788089 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m17:50:45.788396 [info ] [Thread-1  ]: 3 of 3 SKIP relation dev_schema.customers ...................................... [[33mSKIP[0m]
[0m17:50:45.789034 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m17:50:45.849137 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:50:45.849749 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:45.850167 [debug] [MainThread]: On master: BEGIN
[0m17:50:45.850533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:46.006283 [debug] [MainThread]: SQL status: BEGIN in 0.16 seconds
[0m17:50:46.006700 [debug] [MainThread]: On master: COMMIT
[0m17:50:46.007092 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:46.007385 [debug] [MainThread]: On master: COMMIT
[0m17:50:46.026613 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:50:46.027241 [debug] [MainThread]: On master: Close
[0m17:50:46.028100 [info ] [MainThread]: 
[0m17:50:46.028463 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m17:50:46.028838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:46.029111 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m17:50:46.037014 [info ] [MainThread]: 
[0m17:50:46.037410 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:50:46.037829 [info ] [MainThread]: 
[0m17:50:46.038147 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/stg_customers.sql)[0m
[0m17:50:46.038437 [error] [MainThread]:   relation "jaffle_shop_customers" does not exist
[0m17:50:46.038728 [error] [MainThread]:   LINE 13: from jaffle_shop_customers
[0m17:50:46.039012 [error] [MainThread]:                 ^
[0m17:50:46.039312 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/stg_customers.sql
[0m17:50:46.039585 [info ] [MainThread]: 
[0m17:50:46.039852 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/stg_orders.sql)[0m
[0m17:50:46.040106 [error] [MainThread]:   relation "jaffle_shop_orders" does not exist
[0m17:50:46.040391 [error] [MainThread]:   LINE 14: from jaffle_shop_orders
[0m17:50:46.040678 [error] [MainThread]:                 ^
[0m17:50:46.040965 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/models/stg_orders.sql
[0m17:50:46.041242 [info ] [MainThread]: 
[0m17:50:46.041539 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m17:50:46.041943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2caa03510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca9f2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ca9f2690>]}
[0m17:50:46.042213 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:51:17.548126 | ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a ==============================
[0m17:51:17.548189 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:51:17.549096 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:51:17.549438 [debug] [MainThread]: Tracking: tracking
[0m17:51:17.574060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9219fc0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9219fc07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9219fc0310>]}
[0m17:51:17.711438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:51:17.711899 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_customers.sql
[0m17:51:17.712201 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/stg_orders.sql
[0m17:51:17.728387 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m17:51:17.743040 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m17:51:17.764975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a23c710>]}
[0m17:51:17.772998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9219fbba10>]}
[0m17:51:17.773367 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:51:17.773687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9219fbb210>]}
[0m17:51:17.775086 [info ] [MainThread]: 
[0m17:51:17.775941 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:51:17.777597 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m17:51:17.791551 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m17:51:17.791815 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m17:51:17.792063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:17.968552 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.18 seconds
[0m17:51:17.972124 [debug] [ThreadPool]: On list_tradekit: Close
[0m17:51:17.974734 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:51:17.983167 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:51:17.983439 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:51:17.983605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:18.167267 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m17:51:18.167891 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:51:18.168334 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:51:18.203594 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.03 seconds
[0m17:51:18.206924 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:51:18.227188 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:51:18.238446 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:18.238750 [debug] [MainThread]: On master: BEGIN
[0m17:51:18.238952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:18.391332 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
[0m17:51:18.392039 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:18.392480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:18.474784 [debug] [MainThread]: SQL status: SELECT 35 in 0.08 seconds
[0m17:51:18.479959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a0b7610>]}
[0m17:51:18.480450 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:18.499245 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:18.499910 [debug] [MainThread]: On master: BEGIN
[0m17:51:18.539237 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:51:18.539950 [debug] [MainThread]: On master: COMMIT
[0m17:51:18.540410 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:18.540806 [debug] [MainThread]: On master: COMMIT
[0m17:51:18.559357 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:51:18.560200 [debug] [MainThread]: On master: Close
[0m17:51:18.561603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:18.562371 [info ] [MainThread]: 
[0m17:51:18.565759 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m17:51:18.566297 [info ] [Thread-1  ]: 1 of 3 START sql table model dev_schema.stg_customers .......................... [RUN]
[0m17:51:18.567425 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.567730 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m17:51:18.568022 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m17:51:18.570633 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:51:18.571489 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:18.571714 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m17:51:18.632190 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m17:51:18.633374 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.633659 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: BEGIN
[0m17:51:18.633826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:18.763343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:51:18.763946 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.764360 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "tradekit"."dev_schema"."stg_customers__dbt_tmp"
  as (
    select
    id as customer_id,
    first_name,
    last_name

from jaffle_shop.customers
  );
  
[0m17:51:18.835372 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.07 seconds
[0m17:51:18.847586 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.847844 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "tradekit"."dev_schema"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:51:18.867166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:51:18.900526 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:51:18.900783 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.900937 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m17:51:18.923290 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m17:51:18.934708 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m17:51:18.934965 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "tradekit"."dev_schema"."stg_customers__dbt_backup" cascade
[0m17:51:18.955125 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
[0m17:51:18.957286 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:18.957721 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m17:51:18.958905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a4739d0>]}
[0m17:51:18.959505 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dev_schema.stg_customers ..................... [[32mSELECT 100[0m in 0.39s]
[0m17:51:18.960222 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m17:51:18.960682 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m17:51:18.961086 [info ] [Thread-1  ]: 2 of 3 START sql table model dev_schema.stg_orders ............................. [RUN]
[0m17:51:18.962221 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:18.962729 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m17:51:18.962960 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m17:51:18.968461 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:51:18.969351 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:18.969627 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m17:51:18.987324 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m17:51:18.990323 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:18.990850 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: BEGIN
[0m17:51:18.991374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:19.127116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:51:19.127458 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:19.127717 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "tradekit"."dev_schema"."stg_orders__dbt_tmp"
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from jaffle_shop.orders
  );
  
[0m17:51:19.171599 [debug] [Thread-1  ]: SQL status: SELECT 99 in 0.04 seconds
[0m17:51:19.175863 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:19.176110 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "tradekit"."dev_schema"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:51:19.199492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:51:19.206672 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:51:19.207920 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:19.208476 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m17:51:19.235803 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m17:51:19.241092 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m17:51:19.241355 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "tradekit"."dev_schema"."stg_orders__dbt_backup" cascade
[0m17:51:19.271333 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m17:51:19.274226 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:19.274579 [debug] [Thread-1  ]: On model.jaffle_shop.stg_orders: Close
[0m17:51:19.275311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a222f50>]}
[0m17:51:19.275762 [info ] [Thread-1  ]: 2 of 3 OK created sql table model dev_schema.stg_orders ........................ [[32mSELECT 99[0m in 0.31s]
[0m17:51:19.276338 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m17:51:19.276828 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m17:51:19.277309 [info ] [Thread-1  ]: 3 of 3 START sql table model dev_schema.customers .............................. [RUN]
[0m17:51:19.278554 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m17:51:19.278948 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m17:51:19.279172 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m17:51:19.287471 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:51:19.288705 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:19.289015 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m17:51:19.294586 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m17:51:19.295448 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.295683 [debug] [Thread-1  ]: On model.jaffle_shop.customers: BEGIN
[0m17:51:19.295835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:19.431244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:51:19.432142 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.432940 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

  create  table "tradekit"."dev_schema"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "tradekit"."dev_schema"."stg_customers"

),

orders as (

    select * from "tradekit"."dev_schema"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final

/*

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
*/
  );
  
[0m17:51:19.488370 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.05 seconds
[0m17:51:19.493346 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.493587 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers" rename to "customers__dbt_backup"
[0m17:51:19.515465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:51:19.523675 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.523937 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
alter table "tradekit"."dev_schema"."customers__dbt_tmp" rename to "customers"
[0m17:51:19.543443 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
[0m17:51:19.556912 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:51:19.557175 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.557339 [debug] [Thread-1  ]: On model.jaffle_shop.customers: COMMIT
[0m17:51:19.575203 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m17:51:19.580325 [debug] [Thread-1  ]: Using postgres connection "model.jaffle_shop.customers"
[0m17:51:19.580747 [debug] [Thread-1  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "tradekit"."dev_schema"."customers__dbt_backup" cascade
[0m17:51:19.611249 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m17:51:19.613525 [debug] [Thread-1  ]: finished collecting timing info
[0m17:51:19.613954 [debug] [Thread-1  ]: On model.jaffle_shop.customers: Close
[0m17:51:19.615087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1aa4ca-ca9f-49cf-b5b1-f25c3d874a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a4a4410>]}
[0m17:51:19.616110 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dev_schema.customers ......................... [[32mSELECT 100[0m in 0.34s]
[0m17:51:19.617486 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m17:51:19.703284 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:51:19.703652 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.703918 [debug] [MainThread]: On master: BEGIN
[0m17:51:19.704375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:19.871733 [debug] [MainThread]: SQL status: BEGIN in 0.17 seconds
[0m17:51:19.872239 [debug] [MainThread]: On master: COMMIT
[0m17:51:19.872600 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.872859 [debug] [MainThread]: On master: COMMIT
[0m17:51:19.891311 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:51:19.892050 [debug] [MainThread]: On master: Close
[0m17:51:19.893549 [info ] [MainThread]: 
[0m17:51:19.894314 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m17:51:19.895207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:19.895567 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m17:51:19.905422 [info ] [MainThread]: 
[0m17:51:19.905832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:19.906276 [info ] [MainThread]: 
[0m17:51:19.906640 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:51:19.907146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a4a4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a3f7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921a3f7050>]}
[0m17:51:19.907498 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:58:27.980464 | bb40e7bf-d468-4a55-9690-5aa4d328a707 ==============================
[0m17:58:27.980527 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:58:27.983921 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:58:27.984162 [debug] [MainThread]: Tracking: tracking
[0m17:58:28.018385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde95fc9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9610b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde95fc9610>]}
[0m17:58:28.193700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:28.193943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:28.202111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb40e7bf-d468-4a55-9690-5aa4d328a707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde95fd5690>]}
[0m17:58:28.209658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb40e7bf-d468-4a55-9690-5aa4d328a707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde91b25710>]}
[0m17:58:28.209990 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:58:28.210289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb40e7bf-d468-4a55-9690-5aa4d328a707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde91b25710>]}
[0m17:58:28.211346 [info ] [MainThread]: 
[0m17:58:28.211648 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m17:58:28.217943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde91a66310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde95db8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde95396250>]}
[0m17:58:28.218237 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:58:52.931673 | 3234004e-2838-4c73-b7be-258051cac718 ==============================
[0m17:58:52.931774 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:58:52.933061 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:58:52.933394 [debug] [MainThread]: Tracking: tracking
[0m17:58:52.955569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99580b4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99580b4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99580b4cd0>]}
[0m17:58:53.140259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:58:53.140885 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/schema.yml
[0m17:58:53.246719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3234004e-2838-4c73-b7be-258051cac718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9956864c10>]}
[0m17:58:53.255958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3234004e-2838-4c73-b7be-258051cac718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9958179fd0>]}
[0m17:58:53.256342 [info ] [MainThread]: Found 3 models, 9 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:58:53.256652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3234004e-2838-4c73-b7be-258051cac718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9958178390>]}
[0m17:58:53.258427 [info ] [MainThread]: 
[0m17:58:53.259211 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:58:53.260347 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:58:53.273927 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:58:53.274209 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:58:53.274369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:53.476196 [debug] [ThreadPool]: SQL status: BEGIN in 0.2 seconds
[0m17:58:53.476968 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:58:53.477396 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:58:53.509301 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m17:58:53.511752 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:58:53.531811 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:58:53.543265 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:53.543569 [debug] [MainThread]: On master: BEGIN
[0m17:58:53.543769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:53.671713 [debug] [MainThread]: SQL status: BEGIN in 0.13 seconds
[0m17:58:53.672183 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:53.672531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:53.742060 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m17:58:53.746978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3234004e-2838-4c73-b7be-258051cac718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995824d490>]}
[0m17:58:53.747490 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:53.767655 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:53.768255 [debug] [MainThread]: On master: BEGIN
[0m17:58:53.808906 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m17:58:53.809530 [debug] [MainThread]: On master: COMMIT
[0m17:58:53.809955 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:53.810352 [debug] [MainThread]: On master: COMMIT
[0m17:58:53.833414 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:58:53.834153 [debug] [MainThread]: On master: Close
[0m17:58:53.835537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:53.836363 [info ] [MainThread]: 
[0m17:58:53.849540 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:58:53.850130 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m17:58:53.851901 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:58:53.852410 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:58:53.852871 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:58:53.864149 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:58:53.864883 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:53.865100 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:58:53.887717 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:58:53.888479 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:58:53.888658 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m17:58:53.888829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.023869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:58:54.024523 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:58:54.024979 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "tradekit"."dev_schema"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m17:58:54.038107 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.043241 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.043614 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m17:58:54.064043 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m17:58:54.065733 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.21s]
[0m17:58:54.066953 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:58:54.067561 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:58:54.068190 [info ] [Thread-1  ]: 2 of 9 START test not_null_customers_customer_id ............................... [RUN]
[0m17:58:54.069890 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:58:54.070371 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:58:54.070801 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:58:54.082508 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:58:54.083231 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.083448 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:58:54.086255 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:58:54.086832 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:58:54.087011 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: BEGIN
[0m17:58:54.087171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.231849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:58:54.232505 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:58:54.232943 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "tradekit"."dev_schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:58:54.246330 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.249850 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.250254 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m17:58:54.268092 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m17:58:54.269797 [info ] [Thread-1  ]: 2 of 9 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.20s]
[0m17:58:54.271142 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:58:54.271778 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:54.272404 [info ] [Thread-1  ]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m17:58:54.274116 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:54.274600 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:54.275015 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:54.282846 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:54.283531 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.283742 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:54.286433 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:54.286990 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:54.287181 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m17:58:54.287337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.419601 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:58:54.420075 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:58:54.420371 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "tradekit"."dev_schema"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:58:54.430804 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.434469 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.434839 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m17:58:54.451434 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m17:58:54.452463 [info ] [Thread-1  ]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.18s]
[0m17:58:54.453068 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:58:54.453331 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m17:58:54.453631 [info ] [Thread-1  ]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m17:58:54.454463 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m17:58:54.454671 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m17:58:54.454840 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m17:58:54.460792 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m17:58:54.461441 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.461749 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m17:58:54.464993 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m17:58:54.468018 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m17:58:54.468407 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m17:58:54.468684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.581164 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m17:58:54.581585 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m17:58:54.581855 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "tradekit"."dev_schema"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m17:58:54.590680 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.592797 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.593043 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m17:58:54.611831 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m17:58:54.613533 [info ] [Thread-1  ]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.16s]
[0m17:58:54.615014 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m17:58:54.615515 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:58:54.615953 [info ] [Thread-1  ]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m17:58:54.617234 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:58:54.617576 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:58:54.617859 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:58:54.624214 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:58:54.624904 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.625292 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:58:54.629378 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:58:54.629996 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:58:54.630194 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:58:54.630345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.744083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m17:58:54.744722 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:58:54.745089 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "tradekit"."dev_schema"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:58:54.755689 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.759417 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.759910 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:58:54.779987 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:58:54.781687 [info ] [Thread-1  ]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m17:58:54.783017 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:58:54.783656 [debug] [Thread-1  ]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m17:58:54.784298 [info ] [Thread-1  ]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m17:58:54.785931 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m17:58:54.786388 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m17:58:54.786795 [debug] [Thread-1  ]: Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m17:58:54.796284 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m17:58:54.797022 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.797250 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m17:58:54.800101 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m17:58:54.800684 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m17:58:54.800891 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m17:58:54.801048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:54.935915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:58:54.936595 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m17:58:54.937035 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "tradekit"."dev_schema"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "tradekit"."dev_schema"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:58:54.949830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:54.953484 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.954191 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m17:58:54.972022 [debug] [Thread-1  ]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m17:58:54.973831 [info ] [Thread-1  ]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.19s]
[0m17:58:54.975027 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m17:58:54.975633 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:58:54.976254 [info ] [Thread-1  ]: 7 of 9 START test unique_customers_customer_id ................................. [RUN]
[0m17:58:54.977959 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:58:54.978444 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:58:54.978864 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:58:54.990683 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:58:54.991309 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:54.991519 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:58:54.994217 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:58:54.994775 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:58:54.994948 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: BEGIN
[0m17:58:54.995095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:55.127918 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:58:55.128547 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:58:55.129006 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "tradekit"."dev_schema"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:55.151078 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m17:58:55.154319 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:55.154692 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m17:58:55.171856 [debug] [Thread-1  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m17:58:55.173617 [info ] [Thread-1  ]: 7 of 9 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 0.20s]
[0m17:58:55.174940 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:58:55.175695 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:58:55.176225 [info ] [Thread-1  ]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m17:58:55.177373 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:58:55.177692 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:58:55.177967 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:58:55.183997 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:58:55.184596 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:55.184799 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:58:55.187589 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:58:55.188196 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:58:55.188376 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m17:58:55.188531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:55.331955 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m17:58:55.332776 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:58:55.333282 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "tradekit"."dev_schema"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:55.349616 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:55.353119 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:55.353639 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m17:58:55.391850 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m17:58:55.393548 [info ] [Thread-1  ]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.22s]
[0m17:58:55.394689 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:58:55.395217 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:58:55.395817 [info ] [Thread-1  ]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m17:58:55.397515 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:58:55.397996 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:58:55.398410 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:58:55.406219 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:58:55.406874 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:55.407101 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:58:55.409809 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:58:55.410389 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:58:55.410566 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:58:55.410715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:58:55.543930 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m17:58:55.544879 [debug] [Thread-1  ]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:58:55.545293 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "tradekit"."dev_schema"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:55.559681 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m17:58:55.563885 [debug] [Thread-1  ]: finished collecting timing info
[0m17:58:55.564293 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:58:55.603296 [debug] [Thread-1  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:58:55.605734 [info ] [Thread-1  ]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.21s]
[0m17:58:55.607084 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:58:55.689076 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:58:55.689689 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:55.690083 [debug] [MainThread]: On master: BEGIN
[0m17:58:55.690448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:55.831673 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
[0m17:58:55.832208 [debug] [MainThread]: On master: COMMIT
[0m17:58:55.832563 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:55.832874 [debug] [MainThread]: On master: COMMIT
[0m17:58:55.852809 [debug] [MainThread]: SQL status: COMMIT in 0.02 seconds
[0m17:58:55.853172 [debug] [MainThread]: On master: Close
[0m17:58:55.853891 [info ] [MainThread]: 
[0m17:58:55.854231 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m17:58:55.854591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:55.854765 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:58:55.867008 [info ] [MainThread]: 
[0m17:58:55.867558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:55.868080 [info ] [MainThread]: 
[0m17:58:55.868492 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:58:55.869012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9954b056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99585c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99585c5550>]}
[0m17:58:55.869500 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 17:59:58.825843 | e2afaa71-a519-4e31-a7cd-55145330757f ==============================
[0m17:59:58.825904 [info ] [MainThread]: Running with dbt=1.3.0
[0m17:59:58.829154 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m17:59:58.829545 [debug] [MainThread]: Tracking: tracking
[0m17:59:58.856172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca828f4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca829d13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca828f4c90>]}
[0m17:59:59.072031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:59.072838 [debug] [MainThread]: Partial parsing: update schema file: jaffle_shop://models/schema.yml
[0m17:59:59.088455 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m17:59:59.105240 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m17:59:59.108696 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m17:59:59.188128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2afaa71-a519-4e31-a7cd-55145330757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca828ee810>]}
[0m17:59:59.197123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2afaa71-a519-4e31-a7cd-55145330757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca82a1ac10>]}
[0m17:59:59.197489 [info ] [MainThread]: Found 3 models, 7 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:59:59.197790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2afaa71-a519-4e31-a7cd-55145330757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca82a1a750>]}
[0m17:59:59.199283 [info ] [MainThread]: 
[0m17:59:59.200038 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:59:59.201058 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m17:59:59.215068 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:59:59.215312 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m17:59:59.215468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:59.417952 [debug] [ThreadPool]: SQL status: BEGIN in 0.2 seconds
[0m17:59:59.418286 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m17:59:59.418469 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m17:59:59.453447 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m17:59:59.456025 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m17:59:59.474576 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m17:59:59.481260 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:59.481511 [debug] [MainThread]: On master: BEGIN
[0m17:59:59.481676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:59.630378 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
[0m17:59:59.631142 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:59.631572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:59.701756 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m17:59:59.707139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2afaa71-a519-4e31-a7cd-55145330757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca828ffed0>]}
[0m17:59:59.707698 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:59.726962 [debug] [MainThread]: On master: Close
[0m17:59:59.729012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:59.729961 [info ] [MainThread]: 
[0m17:59:59.734024 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m17:59:59.734828 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_customers"
[0m17:59:59.735063 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m17:59:59.735277 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_customers
[0m17:59:59.737634 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m17:59:59.738408 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.738634 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m17:59:59.738823 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.739522 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m17:59:59.739744 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_orders
[0m17:59:59.740264 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.stg_orders"
[0m17:59:59.740448 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_orders
[0m17:59:59.740617 [debug] [Thread-1  ]: Compiling model.jaffle_shop.stg_orders
[0m17:59:59.742668 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m17:59:59.743730 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.743984 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_orders
[0m17:59:59.744168 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.744878 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_orders
[0m17:59:59.745100 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:59:59.745629 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:59:59.745806 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:59:59.745970 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:59:59.759486 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m17:59:59.760621 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.760897 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:59:59.761125 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.761846 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m17:59:59.762113 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:59:59.762813 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:59:59.763043 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:59:59.763217 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:59:59.773167 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m17:59:59.774250 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.774672 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:59:59.774984 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.776108 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m17:59:59.776514 [debug] [Thread-1  ]: Began running node model.jaffle_shop.customers
[0m17:59:59.777432 [debug] [Thread-1  ]: Acquiring new postgres connection "model.jaffle_shop.customers"
[0m17:59:59.777831 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.customers
[0m17:59:59.778104 [debug] [Thread-1  ]: Compiling model.jaffle_shop.customers
[0m17:59:59.782921 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m17:59:59.783769 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.784028 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.customers
[0m17:59:59.784201 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.785429 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.customers
[0m17:59:59.786081 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:59:59.786741 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:59:59.786959 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:59:59.787129 [debug] [Thread-1  ]: Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:59:59.796943 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m17:59:59.797831 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.798053 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:59:59.798224 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.798849 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m17:59:59.799053 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:59.799508 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:59.799675 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:59.799826 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:59.806024 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:59.806848 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.807096 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:59.807276 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.807901 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:59.808103 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:59:59.808861 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:59.809188 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:59:59.809377 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:59:59.814041 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:59.814748 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.814958 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:59:59.815125 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.815744 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m17:59:59.815950 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:59:59.816405 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:59:59.816572 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:59:59.816726 [debug] [Thread-1  ]: Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:59:59.821556 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m17:59:59.822341 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.822556 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:59:59.822822 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.823465 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m17:59:59.823672 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:59:59.824133 [debug] [Thread-1  ]: Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:59:59.824302 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:59:59.824455 [debug] [Thread-1  ]: Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:59:59.829164 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m17:59:59.830024 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.830297 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:59:59.830483 [debug] [Thread-1  ]: finished collecting timing info
[0m17:59:59.831123 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m17:59:59.838895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:59.839454 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m17:59:59.851580 [info ] [MainThread]: Done.
[0m17:59:59.892992 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m17:59:59.893464 [info ] [MainThread]: Building catalog
[0m17:59:59.895743 [debug] [ThreadPool]: Acquiring new postgres connection "tradekit.information_schema"
[0m17:59:59.904908 [debug] [ThreadPool]: Using postgres connection "tradekit.information_schema"
[0m17:59:59.905179 [debug] [ThreadPool]: On tradekit.information_schema: BEGIN
[0m17:59:59.905334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:00.050983 [debug] [ThreadPool]: SQL status: BEGIN in 0.15 seconds
[0m18:00:00.051623 [debug] [ThreadPool]: Using postgres connection "tradekit.information_schema"
[0m18:00:00.052064 [debug] [ThreadPool]: On tradekit.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "tradekit.information_schema"} */

    
    

    select
        'tradekit' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_schema'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:00:00.088985 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.04 seconds
[0m18:00:00.107613 [debug] [ThreadPool]: On tradekit.information_schema: ROLLBACK
[0m18:00:00.126089 [debug] [ThreadPool]: On tradekit.information_schema: Close
[0m18:00:00.147298 [info ] [MainThread]: Catalog written to /Users/heiko/Documents/DataScience/dbt-tutorial/jaffle_shop/target/catalog.json
[0m18:00:00.147834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca82a70290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca82a704d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca8114a690>]}
[0m18:00:00.148170 [debug] [MainThread]: Flushing usage events
[0m18:00:00.902811 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:00:00.903198 [debug] [MainThread]: Connection 'tradekit.information_schema' was properly closed.


============================== 2022-10-18 18:00:09.047060 | e4573a43-881a-49f3-b65a-be440565534c ==============================
[0m18:00:09.047249 [info ] [MainThread]: Running with dbt=1.3.0
[0m18:00:09.048622 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m18:00:09.048967 [debug] [MainThread]: Tracking: tracking
[0m18:00:09.075142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbebc7f4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbebc7f4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbebc7f45d0>]}
[0m18:00:09.080251 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m18:00:09.080836 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m18:00:09.081180 [info ] [MainThread]: 
[0m18:00:09.081500 [info ] [MainThread]: 
[0m18:00:09.081840 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-10-21 12:28:44.913395 | 710dc50e-123d-4397-a339-9e8208e002b6 ==============================
[0m12:28:44.913450 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:28:44.915454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m12:28:44.915767 [debug] [MainThread]: Tracking: tracking
[0m12:28:45.019033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9449ff3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9449ff38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9449ff3850>]}
[0m12:28:45.835715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:28:45.836367 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/mock_orders.sql
[0m12:28:45.836796 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/sdc2_data.sql
[0m12:28:45.856353 [debug] [MainThread]: 1699: static parser successfully parsed sdc2_data.sql
[0m12:28:45.896325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944a3ab110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944a362410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944a3a9f90>]}
[0m12:28:45.896650 [debug] [MainThread]: Flushing usage events
[0m12:28:47.052439 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot mock_orders (snapshots/mock_orders.sql)
  Encountered unknown tag 'SET'.
    line 2
      {% SET new_schema = 'dbt' + '_snapshot' %}


============================== 2022-10-21 12:29:06.680934 | 394dd976-a91a-446a-ac2a-ea5b88f17546 ==============================
[0m12:29:06.681030 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:29:06.682984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m12:29:06.683428 [debug] [MainThread]: Tracking: tracking
[0m12:29:06.747071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b969dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b969df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b969dfd0>]}
[0m12:29:07.054345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:29:07.054860 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/mock_orders.sql
[0m12:29:07.055139 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/sdc2_data.sql
[0m12:29:07.074055 [debug] [MainThread]: 1699: static parser successfully parsed sdc2_data.sql
[0m12:29:07.118083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b7736410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b9aa60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5b9a37dd0>]}
[0m12:29:07.118539 [debug] [MainThread]: Flushing usage events
[0m12:29:07.639088 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot mock_orders (snapshots/mock_orders.sql)
  Encountered unknown tag 'SET'.
    line 2
      {% SET new_schema = 'dbt_snapshot' %}


============================== 2022-10-21 12:30:53.275181 | 6ef8f677-941d-495f-810e-7d8bfd170a31 ==============================
[0m12:30:53.275213 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:30:53.277106 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m12:30:53.277440 [debug] [MainThread]: Tracking: tracking
[0m12:30:53.340536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe380f4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe380f4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe380f4450>]}
[0m12:30:53.632174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:30:53.633127 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://snapshots/mock_orders.sql
[0m12:30:53.633765 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/sdc2_data.sql
[0m12:30:53.652835 [debug] [MainThread]: 1699: static parser successfully parsed sdc2_data.sql
[0m12:30:53.716013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ef8f677-941d-495f-810e-7d8bfd170a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe38142290>]}
[0m12:30:53.789697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ef8f677-941d-495f-810e-7d8bfd170a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe38235710>]}
[0m12:30:53.790282 [info ] [MainThread]: Found 4 models, 7 tests, 1 snapshot, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:30:53.791083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef8f677-941d-495f-810e-7d8bfd170a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe38235dd0>]}
[0m12:30:53.794597 [info ] [MainThread]: 
[0m12:30:53.796565 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:30:53.799496 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m12:30:53.818526 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m12:30:53.818789 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m12:30:53.818946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:54.046625 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.23 seconds
[0m12:30:54.050300 [debug] [ThreadPool]: On list_tradekit: Close
[0m12:30:54.052098 [debug] [ThreadPool]: Acquiring new postgres connection "create_tradekit_snapshots"
[0m12:30:54.052910 [debug] [ThreadPool]: Acquiring new postgres connection "create_tradekit_snapshots"
[0m12:30:54.053281 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='tradekit', schema='snapshots', identifier=None)"
[0m12:30:54.061279 [debug] [ThreadPool]: Using postgres connection "create_tradekit_snapshots"
[0m12:30:54.061556 [debug] [ThreadPool]: On create_tradekit_snapshots: BEGIN
[0m12:30:54.061730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:54.157935 [debug] [ThreadPool]: SQL status: BEGIN in 0.1 seconds
[0m12:30:54.158566 [debug] [ThreadPool]: Using postgres connection "create_tradekit_snapshots"
[0m12:30:54.158974 [debug] [ThreadPool]: On create_tradekit_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_tradekit_snapshots"} */
create schema if not exists "snapshots"
[0m12:30:54.166085 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
[0m12:30:54.169076 [debug] [ThreadPool]: On create_tradekit_snapshots: COMMIT
[0m12:30:54.169604 [debug] [ThreadPool]: Using postgres connection "create_tradekit_snapshots"
[0m12:30:54.170046 [debug] [ThreadPool]: On create_tradekit_snapshots: COMMIT
[0m12:30:54.179458 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m12:30:54.180189 [debug] [ThreadPool]: On create_tradekit_snapshots: Close
[0m12:30:54.185100 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_snapshots"
[0m12:30:54.198110 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:30:54.198372 [debug] [ThreadPool]: On list_tradekit_snapshots: BEGIN
[0m12:30:54.198537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:54.273361 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m12:30:54.274172 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:30:54.274701 [debug] [ThreadPool]: On list_tradekit_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_snapshots"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m12:30:54.301550 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.03 seconds
[0m12:30:54.304760 [debug] [ThreadPool]: On list_tradekit_snapshots: ROLLBACK
[0m12:30:54.314724 [debug] [ThreadPool]: On list_tradekit_snapshots: Close
[0m12:30:54.317128 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m12:30:54.321848 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:30:54.322201 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m12:30:54.322394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:54.401510 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m12:30:54.402288 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:30:54.402712 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m12:30:54.428831 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m12:30:54.432213 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m12:30:54.439476 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m12:30:54.450852 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.451162 [debug] [MainThread]: On master: BEGIN
[0m12:30:54.451369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:54.536062 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m12:30:54.536712 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.537148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:30:54.606157 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m12:30:54.611297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef8f677-941d-495f-810e-7d8bfd170a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe383a1c90>]}
[0m12:30:54.611810 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:54.619152 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.619818 [debug] [MainThread]: On master: BEGIN
[0m12:30:54.633747 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m12:30:54.634434 [debug] [MainThread]: On master: COMMIT
[0m12:30:54.634872 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.635258 [debug] [MainThread]: On master: COMMIT
[0m12:30:54.640414 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:30:54.641139 [debug] [MainThread]: On master: Close
[0m12:30:54.642684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:54.643458 [info ] [MainThread]: 
[0m12:30:54.649149 [debug] [Thread-1  ]: Began running node snapshot.jaffle_shop.mock_orders
[0m12:30:54.649716 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.mock_orders .................................... [RUN]
[0m12:30:54.650635 [debug] [Thread-1  ]: Acquiring new postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:30:54.650888 [debug] [Thread-1  ]: Began compiling node snapshot.jaffle_shop.mock_orders
[0m12:30:54.651114 [debug] [Thread-1  ]: Compiling snapshot.jaffle_shop.mock_orders
[0m12:30:54.655603 [debug] [Thread-1  ]: finished collecting timing info
[0m12:30:54.655882 [debug] [Thread-1  ]: Began executing node snapshot.jaffle_shop.mock_orders
[0m12:30:54.722776 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.jaffle_shop.mock_orders"
[0m12:30:54.723577 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:30:54.723761 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: BEGIN
[0m12:30:54.723905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:54.814028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
[0m12:30:54.814687 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:30:54.815114 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      
  
    

  create  table "tradekit"."snapshots"."mock_orders"
  as (
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        




select * from public.mock_orders

    ) sbq



  );
  
  
[0m12:30:54.827181 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.mock_orders" does not exist
LINE 24: select * from public.mock_orders
                       ^

[0m12:30:54.827838 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: ROLLBACK
[0m12:30:54.835072 [debug] [Thread-1  ]: finished collecting timing info
[0m12:30:54.835717 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: Close
[0m12:30:54.837140 [debug] [Thread-1  ]: Database Error in snapshot mock_orders (snapshots/mock_orders.sql)
  relation "public.mock_orders" does not exist
  LINE 24: select * from public.mock_orders
                         ^
  compiled Code at target/run/jaffle_shop/snapshots/mock_orders.sql
[0m12:30:54.837825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ef8f677-941d-495f-810e-7d8bfd170a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe380f4490>]}
[0m12:30:54.838755 [error] [Thread-1  ]: 1 of 1 ERROR snapshotting snapshots.mock_orders ................................ [[31mERROR[0m in 0.19s]
[0m12:30:54.839636 [debug] [Thread-1  ]: Finished running node snapshot.jaffle_shop.mock_orders
[0m12:30:54.856605 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:30:54.857242 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.857650 [debug] [MainThread]: On master: BEGIN
[0m12:30:54.858025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:54.952134 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
[0m12:30:54.952836 [debug] [MainThread]: On master: COMMIT
[0m12:30:54.953275 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:54.953661 [debug] [MainThread]: On master: COMMIT
[0m12:30:54.959212 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m12:30:54.959939 [debug] [MainThread]: On master: Close
[0m12:30:54.961472 [info ] [MainThread]: 
[0m12:30:54.962248 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m12:30:54.963472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:54.963863 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.mock_orders' was properly closed.
[0m12:30:54.974459 [info ] [MainThread]: 
[0m12:30:54.974837 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:54.975311 [info ] [MainThread]: 
[0m12:30:54.975694 [error] [MainThread]: [33mDatabase Error in snapshot mock_orders (snapshots/mock_orders.sql)[0m
[0m12:30:54.976041 [error] [MainThread]:   relation "public.mock_orders" does not exist
[0m12:30:54.976325 [error] [MainThread]:   LINE 24: select * from public.mock_orders
[0m12:30:54.976594 [error] [MainThread]:                          ^
[0m12:30:54.976861 [error] [MainThread]:   compiled Code at target/run/jaffle_shop/snapshots/mock_orders.sql
[0m12:30:54.977142 [info ] [MainThread]: 
[0m12:30:54.977432 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:30:54.977829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe34242490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe3846be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe3846bf10>]}
[0m12:30:54.978092 [debug] [MainThread]: Flushing usage events


============================== 2022-10-21 12:31:41.385072 | f8004968-2a5f-46a6-839c-a67534ac6d45 ==============================
[0m12:31:41.385105 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:31:41.387174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m12:31:41.387505 [debug] [MainThread]: Tracking: tracking
[0m12:31:41.432513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d0f4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d0f4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d0f4650>]}
[0m12:31:41.721962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:41.723161 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://snapshots/mock_orders.sql
[0m12:31:41.787537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8004968-2a5f-46a6-839c-a67534ac6d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d4ad790>]}
[0m12:31:41.798295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8004968-2a5f-46a6-839c-a67534ac6d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d32f510>]}
[0m12:31:41.799213 [info ] [MainThread]: Found 4 models, 7 tests, 1 snapshot, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:31:41.799749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8004968-2a5f-46a6-839c-a67534ac6d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d32fa10>]}
[0m12:31:41.801581 [info ] [MainThread]: 
[0m12:31:41.802425 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:31:41.803406 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m12:31:41.816880 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m12:31:41.817154 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m12:31:41.817316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:41.949153 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.13 seconds
[0m12:31:41.952882 [debug] [ThreadPool]: On list_tradekit: Close
[0m12:31:41.955701 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_snapshots"
[0m12:31:41.963957 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:31:41.964213 [debug] [ThreadPool]: On list_tradekit_snapshots: BEGIN
[0m12:31:41.964374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:42.044957 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m12:31:42.045599 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:31:42.046024 [debug] [ThreadPool]: On list_tradekit_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_snapshots"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m12:31:42.070754 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.02 seconds
[0m12:31:42.073942 [debug] [ThreadPool]: On list_tradekit_snapshots: ROLLBACK
[0m12:31:42.081360 [debug] [ThreadPool]: On list_tradekit_snapshots: Close
[0m12:31:42.083821 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m12:31:42.088231 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:31:42.088530 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m12:31:42.088785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:42.160833 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m12:31:42.161368 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:31:42.161704 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m12:31:42.189117 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m12:31:42.192870 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m12:31:42.199358 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m12:31:42.210442 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.210771 [debug] [MainThread]: On master: BEGIN
[0m12:31:42.210972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:42.294814 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m12:31:42.295794 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.296718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:31:42.368007 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m12:31:42.372973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8004968-2a5f-46a6-839c-a67534ac6d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d4439d0>]}
[0m12:31:42.373492 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:42.380301 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.381275 [debug] [MainThread]: On master: BEGIN
[0m12:31:42.395996 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m12:31:42.396644 [debug] [MainThread]: On master: COMMIT
[0m12:31:42.397073 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.397461 [debug] [MainThread]: On master: COMMIT
[0m12:31:42.404224 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m12:31:42.405150 [debug] [MainThread]: On master: Close
[0m12:31:42.406546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:42.407294 [info ] [MainThread]: 
[0m12:31:42.412660 [debug] [Thread-1  ]: Began running node snapshot.jaffle_shop.mock_orders
[0m12:31:42.413221 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.mock_orders .................................... [RUN]
[0m12:31:42.414426 [debug] [Thread-1  ]: Acquiring new postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:31:42.414722 [debug] [Thread-1  ]: Began compiling node snapshot.jaffle_shop.mock_orders
[0m12:31:42.414971 [debug] [Thread-1  ]: Compiling snapshot.jaffle_shop.mock_orders
[0m12:31:42.420293 [debug] [Thread-1  ]: finished collecting timing info
[0m12:31:42.420925 [debug] [Thread-1  ]: Began executing node snapshot.jaffle_shop.mock_orders
[0m12:31:42.488863 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.jaffle_shop.mock_orders"
[0m12:31:42.490272 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:31:42.490483 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: BEGIN
[0m12:31:42.490629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:31:42.573074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.08 seconds
[0m12:31:42.573919 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:31:42.574335 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      
  
    

  create  table "tradekit"."snapshots"."mock_orders"
  as (
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        




select * from jaffle_shop.mock_orders

    ) sbq



  );
  
  
[0m12:31:42.606790 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.03 seconds
[0m12:31:42.638401 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: COMMIT
[0m12:31:42.638667 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:31:42.638837 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: COMMIT
[0m12:31:42.655883 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m12:31:42.657567 [debug] [Thread-1  ]: finished collecting timing info
[0m12:31:42.658270 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: Close
[0m12:31:42.660145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8004968-2a5f-46a6-839c-a67534ac6d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d519f50>]}
[0m12:31:42.660829 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.mock_orders .................................... [[32mSELECT 4[0m in 0.25s]
[0m12:31:42.661585 [debug] [Thread-1  ]: Finished running node snapshot.jaffle_shop.mock_orders
[0m12:31:42.721908 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:31:42.722614 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.723015 [debug] [MainThread]: On master: BEGIN
[0m12:31:42.723377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:42.826058 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
[0m12:31:42.826742 [debug] [MainThread]: On master: COMMIT
[0m12:31:42.827178 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:42.827551 [debug] [MainThread]: On master: COMMIT
[0m12:31:42.835202 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m12:31:42.835922 [debug] [MainThread]: On master: Close
[0m12:31:42.837447 [info ] [MainThread]: 
[0m12:31:42.838191 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m12:31:42.839028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:42.839520 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.mock_orders' was properly closed.
[0m12:31:42.850170 [info ] [MainThread]: 
[0m12:31:42.850608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:42.851049 [info ] [MainThread]: 
[0m12:31:42.851393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:31:42.851779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d544450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d39b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7d39b210>]}
[0m12:31:42.852070 [debug] [MainThread]: Flushing usage events


============================== 2022-10-21 12:37:02.769526 | a0294d38-db05-440d-9b6a-f9764b688544 ==============================
[0m12:37:02.769613 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:37:02.771143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/heiko/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m12:37:02.771431 [debug] [MainThread]: Tracking: tracking
[0m12:37:02.821406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96638b3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96638b3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96638b3c50>]}
[0m12:37:03.074413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:03.074684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:03.084839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0294d38-db05-440d-9b6a-f9764b688544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9663b34e10>]}
[0m12:37:03.096253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0294d38-db05-440d-9b6a-f9764b688544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96639ef7d0>]}
[0m12:37:03.096652 [info ] [MainThread]: Found 4 models, 7 tests, 1 snapshot, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:37:03.096979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0294d38-db05-440d-9b6a-f9764b688544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96639ef750>]}
[0m12:37:03.098531 [info ] [MainThread]: 
[0m12:37:03.099370 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:37:03.100331 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit"
[0m12:37:03.113629 [debug] [ThreadPool]: Using postgres connection "list_tradekit"
[0m12:37:03.113932 [debug] [ThreadPool]: On list_tradekit: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit"} */

    select distinct nspname from pg_namespace
  
[0m12:37:03.114098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.248523 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.13 seconds
[0m12:37:03.252342 [debug] [ThreadPool]: On list_tradekit: Close
[0m12:37:03.255531 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_snapshots"
[0m12:37:03.263831 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:37:03.264107 [debug] [ThreadPool]: On list_tradekit_snapshots: BEGIN
[0m12:37:03.264274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:03.349081 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m12:37:03.349730 [debug] [ThreadPool]: Using postgres connection "list_tradekit_snapshots"
[0m12:37:03.350155 [debug] [ThreadPool]: On list_tradekit_snapshots: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_snapshots"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m12:37:03.374545 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.02 seconds
[0m12:37:03.377760 [debug] [ThreadPool]: On list_tradekit_snapshots: ROLLBACK
[0m12:37:03.382883 [debug] [ThreadPool]: On list_tradekit_snapshots: Close
[0m12:37:03.385374 [debug] [ThreadPool]: Acquiring new postgres connection "list_tradekit_dev_schema"
[0m12:37:03.391322 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:37:03.391671 [debug] [ThreadPool]: On list_tradekit_dev_schema: BEGIN
[0m12:37:03.391917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:03.462420 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m12:37:03.463068 [debug] [ThreadPool]: Using postgres connection "list_tradekit_dev_schema"
[0m12:37:03.463491 [debug] [ThreadPool]: On list_tradekit_dev_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_tradekit_dev_schema"} */
select
      'tradekit' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_schema'
    union all
    select
      'tradekit' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_schema'
  
[0m12:37:03.487776 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m12:37:03.491458 [debug] [ThreadPool]: On list_tradekit_dev_schema: ROLLBACK
[0m12:37:03.498202 [debug] [ThreadPool]: On list_tradekit_dev_schema: Close
[0m12:37:03.509395 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.509666 [debug] [MainThread]: On master: BEGIN
[0m12:37:03.509841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:03.579857 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m12:37:03.580160 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.580330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:03.650133 [debug] [MainThread]: SQL status: SELECT 35 in 0.07 seconds
[0m12:37:03.655326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0294d38-db05-440d-9b6a-f9764b688544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96634ec810>]}
[0m12:37:03.655892 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:03.660637 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.661519 [debug] [MainThread]: On master: BEGIN
[0m12:37:03.673437 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m12:37:03.674146 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.674586 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.674967 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.680106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:37:03.680821 [debug] [MainThread]: On master: Close
[0m12:37:03.682225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:03.682988 [info ] [MainThread]: 
[0m12:37:03.688462 [debug] [Thread-1  ]: Began running node snapshot.jaffle_shop.mock_orders
[0m12:37:03.689018 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.mock_orders .................................... [RUN]
[0m12:37:03.689914 [debug] [Thread-1  ]: Acquiring new postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:03.690151 [debug] [Thread-1  ]: Began compiling node snapshot.jaffle_shop.mock_orders
[0m12:37:03.690365 [debug] [Thread-1  ]: Compiling snapshot.jaffle_shop.mock_orders
[0m12:37:03.695073 [debug] [Thread-1  ]: finished collecting timing info
[0m12:37:03.695347 [debug] [Thread-1  ]: Began executing node snapshot.jaffle_shop.mock_orders
[0m12:37:03.769590 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:03.769836 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: BEGIN
[0m12:37:03.769991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:03.848430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.08 seconds
[0m12:37:03.848911 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:03.849186 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "tradekit".INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m12:37:03.921021 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.07 seconds
[0m12:37:03.960434 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:03.960680 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

        
  
    

  create temporary table "mock_orders__dbt_tmp143703945075"
  as (
    with snapshot_query as (

        




select * from jaffle_shop.mock_orders


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "tradekit"."snapshots"."mock_orders"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m12:37:03.985670 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
[0m12:37:03.992306 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:03.992640 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders__dbt_tmp143703945075'
        
      order by ordinal_position

  
[0m12:37:04.021729 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.03 seconds
[0m12:37:04.029550 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.029812 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "tradekit".INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m12:37:04.062102 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.03 seconds
[0m12:37:04.069745 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.070016 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders__dbt_tmp143703945075'
        
      order by ordinal_position

  
[0m12:37:04.107059 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.04 seconds
[0m12:37:04.116194 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.116482 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "tradekit".INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m12:37:04.153949 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.04 seconds
[0m12:37:04.167193 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.167445 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mock_orders__dbt_tmp143703945075'
        
      order by ordinal_position

  
[0m12:37:04.197398 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.03 seconds
[0m12:37:04.209612 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.210781 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.211002 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "snapshot.jaffle_shop.mock_orders"} */

      update "tradekit"."snapshots"."mock_orders"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "mock_orders__dbt_tmp143703945075" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "tradekit"."snapshots"."mock_orders".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "tradekit"."snapshots"."mock_orders".dbt_valid_to is null;

    insert into "tradekit"."snapshots"."mock_orders" ("order_id", "status", "created_at", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."status",DBT_INTERNAL_SOURCE."created_at",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "mock_orders__dbt_tmp143703945075" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m12:37:04.224254 [debug] [Thread-1  ]: SQL status: INSERT 0 1 in 0.01 seconds
[0m12:37:04.257868 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: COMMIT
[0m12:37:04.258125 [debug] [Thread-1  ]: Using postgres connection "snapshot.jaffle_shop.mock_orders"
[0m12:37:04.258283 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: COMMIT
[0m12:37:04.267155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m12:37:04.270629 [debug] [Thread-1  ]: finished collecting timing info
[0m12:37:04.270897 [debug] [Thread-1  ]: On snapshot.jaffle_shop.mock_orders: Close
[0m12:37:04.271547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0294d38-db05-440d-9b6a-f9764b688544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9663c5c3d0>]}
[0m12:37:04.271974 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.mock_orders .................................... [[32mINSERT 0 1[0m in 0.58s]
[0m12:37:04.272444 [debug] [Thread-1  ]: Finished running node snapshot.jaffle_shop.mock_orders
[0m12:37:04.313798 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:37:04.314329 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.314571 [debug] [MainThread]: On master: BEGIN
[0m12:37:04.314763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:04.391249 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m12:37:04.391919 [debug] [MainThread]: On master: COMMIT
[0m12:37:04.392330 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.392719 [debug] [MainThread]: On master: COMMIT
[0m12:37:04.400047 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m12:37:04.401061 [debug] [MainThread]: On master: Close
[0m12:37:04.403030 [info ] [MainThread]: 
[0m12:37:04.403848 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m12:37:04.404555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:04.404912 [debug] [MainThread]: Connection 'snapshot.jaffle_shop.mock_orders' was properly closed.
[0m12:37:04.418628 [info ] [MainThread]: 
[0m12:37:04.419064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:04.419502 [info ] [MainThread]: 
[0m12:37:04.419857 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:04.420304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96639e2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9663c365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9663c36c50>]}
[0m12:37:04.420638 [debug] [MainThread]: Flushing usage events
